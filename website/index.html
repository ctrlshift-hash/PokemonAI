<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PokeLoop — Autonomous FireRed Agent</title>
  <meta name="description" content="An autonomous AI agent powered by Claude Opus 4.6 running on a Mac Mini that plays Pokemon FireRed using vision and reasoning. Watch it think, strategize, and play in real-time.">
  <meta property="og:title" content="PokeLoop — Autonomous FireRed Agent">
  <meta property="og:description" content="Claude Opus 4.6 plays Pokemon FireRed autonomously on a Mac Mini. Watch it think, battle, and explore in real-time.">
  <meta property="og:type" content="website">
  <link rel="icon" href="https://static.wixstatic.com/media/e2da02_6f99662cc92a426a98ca98f5c90fe511~mv2.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/pokemon-solid" rel="stylesheet">

  <style>
    /* ═══════════════════════════════════════════
       DESIGN TOKENS — POKEMON FIRERED THEME
       ═══════════════════════════════════════════ */
    :root {
      --bg-primary: #F5F5F8;
      --bg-secondary: #FFFFFF;
      --bg-surface: rgba(220,38,38,0.04);
      --bg-surface-hover: rgba(220,38,38,0.08);
      --bg-surface-alt: #FFFFFF;
      --bg-surface-alt-hover: #FFF5F5;
      --border: rgba(220,38,38,0.15);
      --border-alt: rgba(0,0,0,0.08);
      --border-hover: rgba(220,38,38,0.35);
      --text-primary: #1a1a2e;
      --text-secondary: #4a4a68;
      --text-muted: #8888a0;
      --text-dim: #9898b0;
      --red: #DC2626;
      --red-light: #EF4444;
      --orange: #F97316;
      --gold: #EAB308;
      --yellow: #FACC15;
      --blue: #3B82F6;
      --purple: #8B5CF6;
      --pink: #EC4899;
      --green: #16A34A;
      --cyan: #06B6D4;
      --gradient-fire: linear-gradient(135deg, #DC2626, #F97316, #EAB308);
      --gradient-fire-subtle: linear-gradient(135deg, rgba(220,38,38,0.08), rgba(249,115,22,0.06), rgba(234,179,8,0.04));
      --gradient-fire-text: linear-gradient(135deg, #DC2626, #E04520, #D97706);
      --radius-xl: 24px;
      --radius-lg: 16px;
      --radius-md: 12px;
      --radius-sm: 8px;
      --radius-xs: 6px;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.06);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.07);
      --shadow-lg: 0 10px 30px rgba(0,0,0,0.1);
      --shadow-glow: 0 4px 24px rgba(220,38,38,0.12);
      --shadow-glow-gold: 0 4px 24px rgba(234,179,8,0.12);
      --transition-fast: 0.15s ease;
      --transition-base: 0.3s ease;
      --transition-slow: 0.6s cubic-bezier(0.16, 1, 0.3, 1);
      --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
      --font-pokemon: 'Pokemon Solid', 'Inter', sans-serif;
    }

    /* ═══════════════════════════════════════════
       TYPE COLORS
       ═══════════════════════════════════════════ */
    .type-normal   { --type-color: #A8A878; }
    .type-fire     { --type-color: #F08030; }
    .type-water    { --type-color: #6890F0; }
    .type-grass    { --type-color: #78C850; }
    .type-electric { --type-color: #F8D030; }
    .type-ice      { --type-color: #98D8D8; }
    .type-fighting { --type-color: #C03028; }
    .type-poison   { --type-color: #A040A0; }
    .type-ground   { --type-color: #E0C068; }
    .type-flying   { --type-color: #A890F0; }
    .type-psychic  { --type-color: #F85888; }
    .type-bug      { --type-color: #A8B820; }
    .type-rock     { --type-color: #B8A038; }
    .type-ghost    { --type-color: #705898; }
    .type-dragon   { --type-color: #7038F8; }
    .type-dark     { --type-color: #705848; }
    .type-steel    { --type-color: #B8B8D0; }
    .type-fairy    { --type-color: #EE99AC; }

    /* ═══════════════════════════════════════════
       RESET & BASE
       ═══════════════════════════════════════════ */
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
    body {
      font-family: var(--font-sans);
      background: var(--bg-primary);
      color: var(--text-secondary);
      font-size: 15px;
      line-height: 1.6;
      overflow-x: hidden;
      border-top: 4px solid transparent;
      border-image: var(--gradient-fire) 1;
    }
    ::selection { background: rgba(220,38,38,0.2); color: #1a1a2e; }
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #f0f0f4; }
    ::-webkit-scrollbar-thumb { background: rgba(220,38,38,0.3); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(220,38,38,0.5); }
    a { color: var(--red); text-decoration: none; transition: color var(--transition-fast); }
    a:hover { color: var(--orange); }
    img { display: block; max-width: 100%; }

    /* ═══════════════════════════════════════════
       NOISE OVERLAY
       ═══════════════════════════════════════════ */
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.5'/%3E%3C/svg%3E");
      opacity: 0.015;
      pointer-events: none;
      z-index: 10000;
    }

    /* ═══════════════════════════════════════════
       TYPOGRAPHY
       ═══════════════════════════════════════════ */
    h1, h2, h3, h4 { color: var(--text-primary); font-weight: 700; letter-spacing: -0.02em; line-height: 1.15; }
    h1 {
      font-family: var(--font-pokemon);
      font-size: clamp(48px, 8vw, 84px);
      font-weight: 400;
      letter-spacing: 0.06em;
      line-height: 1.1;
      color: #FFCB05;
      text-shadow:
        -3px -3px 0 #2A75BB,
         3px -3px 0 #2A75BB,
        -3px  3px 0 #2A75BB,
         3px  3px 0 #2A75BB,
         0   -3px 0 #2A75BB,
         0    3px 0 #2A75BB,
        -3px  0   0 #2A75BB,
         3px  0   0 #2A75BB;
    }
    h2 {
      font-family: var(--font-pokemon);
      font-size: clamp(22px, 3vw, 32px);
      font-weight: 400;
      letter-spacing: 0.04em;
      position: relative;
      display: inline-block;
      padding-bottom: 12px;
      color: #FFCB05;
      text-shadow:
        -2px -2px 0 #2A75BB,
         2px -2px 0 #2A75BB,
        -2px  2px 0 #2A75BB,
         2px  2px 0 #2A75BB,
         0   -2px 0 #2A75BB,
         0    2px 0 #2A75BB,
        -2px  0   0 #2A75BB,
         2px  0   0 #2A75BB;
    }
    h2::after {
      content: '';
      position: absolute;
      bottom: 0; left: 0;
      width: 60px; height: 3px;
      background: var(--gradient-fire);
      border-radius: 2px;
    }
    h3 { font-size: 18px; font-weight: 600; }
    .gradient-text {
      color: #FFCB05 !important;
      -webkit-text-fill-color: #FFCB05;
    }
    .section-label {
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--red-light);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .section-label::before {
      content: '';
      width: 24px;
      height: 2px;
      background: var(--gradient-fire);
      border-radius: 1px;
    }
    .section-desc {
      color: var(--text-secondary);
      font-size: 17px;
      line-height: 1.7;
      max-width: 580px;
      margin-top: 12px;
    }

    /* ═══════════════════════════════════════════
       LAYOUT
       ═══════════════════════════════════════════ */
    .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }
    section { padding: 100px 0; position: relative; }

    /* ═══════════════════════════════════════════
       POKEBALL DIVIDER
       ═══════════════════════════════════════════ */
    .pokeball-divider {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      padding: 4px 48px;
      position: relative;
      z-index: 1;
    }
    .pokeball-divider-line {
      flex: 1;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(229,53,53,0.2), rgba(251,140,45,0.15), rgba(229,53,53,0.2), transparent);
    }
    .pokeball-divider svg {
      width: 32px;
      height: 32px;
      opacity: 0.4;
      flex-shrink: 0;
    }

    /* ═══════════════════════════════════════════
       CARD SYSTEM
       ═══════════════════════════════════════════ */
    .card {
      background: #FFFFFF;
      border: 1px solid rgba(0,0,0,0.06);
      border-top: 3px solid rgba(220,38,38,0.25);
      border-radius: var(--radius-lg);
      padding: 28px;
      transition: all var(--transition-base);
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow-sm);
    }
    .card:hover {
      background: #FFFFFF;
      border-color: rgba(220,38,38,0.18);
      border-top-color: rgba(220,38,38,0.7);
      transform: translateY(-6px) scale(1.01);
      box-shadow: 0 12px 32px rgba(220,38,38,0.1), 0 4px 16px rgba(0,0,0,0.08), var(--shadow-glow);
    }
    .card-fire {
      background: var(--bg-surface);
      border-color: var(--border);
    }
    .card-fire:hover {
      background: var(--bg-surface-hover);
    }
    .card-glow::before {
      content: '';
      position: absolute;
      inset: -1px;
      border-radius: var(--radius-lg);
      padding: 1px;
      background: var(--gradient-fire);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      opacity: 0.5;
      transition: opacity var(--transition-base);
    }
    .card-glow:hover::before { opacity: 0.8; }
    .card:not(.stat-card):not(.poke-card)::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 50%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.12), rgba(255,255,255,0.25), rgba(255,255,255,0.12), transparent);
      pointer-events: none;
      z-index: 1;
    }
    .card:not(.stat-card):not(.poke-card):hover::after {
      animation: card-shimmer-sweep 0.6s ease forwards;
    }

    /* ═══════════════════════════════════════════
       SKELETON LOADING
       ═══════════════════════════════════════════ */
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    .skeleton {
      background: linear-gradient(90deg, rgba(0,0,0,0.04) 25%, rgba(0,0,0,0.08) 50%, rgba(0,0,0,0.04) 75%) !important;
      background-size: 200% 100% !important;
      animation: shimmer 1.8s ease-in-out infinite;
      border-radius: var(--radius-sm);
      color: transparent !important;
      pointer-events: none;
      user-select: none;
      min-height: 1.2em;
    }
    .skeleton * { visibility: hidden; }
    .skeleton-block {
      background: linear-gradient(90deg, rgba(0,0,0,0.04) 25%, rgba(0,0,0,0.08) 50%, rgba(0,0,0,0.04) 75%);
      background-size: 200% 100%;
      animation: shimmer 1.8s ease-in-out infinite;
      border-radius: var(--radius-sm);
    }
    .skeleton-line { height: 14px; margin-bottom: 8px; border-radius: 4px; }
    .skeleton-line:last-child { width: 60%; }
    .skeleton-circle { border-radius: 50%; }

    /* ═══════════════════════════════════════════
       LOADER
       ═══════════════════════════════════════════ */
    /* ═══════════════════════════════════════════
       CANVAS BG
       ═══════════════════════════════════════════ */
    #canvas-bg {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }

    /* ═══════════════════════════════════════════
       NAVIGATION
       ═══════════════════════════════════════════ */
    nav {
      position: fixed;
      top: 4px; left: 0; right: 0;
      z-index: 1000;
      height: 56px;
      display: flex;
      align-items: center;
      padding: 0 32px;
      transition: all var(--transition-base);
      background: #FFFFFF;
      border-bottom: 1px solid rgba(0,0,0,0.08);
      box-shadow: 0 1px 4px rgba(0,0,0,0.04);
    }
    nav.scrolled {
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
      border-bottom: 1px solid rgba(220,38,38,0.15);
    }
    .nav-inner {
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
      display: flex;
      align-items: center;
      position: relative;
    }
    .nav-brand {
      position: fixed;
      left: 48px;
      top: 4px;
      height: 56px;
      z-index: 1001;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .nav-brand img { height: 44px; }
    .nav-brand-spacer { display: none; }
    .nav-links {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      align-items: center;
      gap: 16px;
      list-style: none;
      white-space: nowrap;
    }
    .nav-links a {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-muted);
      transition: all 0.25s cubic-bezier(0.16, 1, 0.3, 1);
      position: relative;
      padding: 6px 12px;
      border-radius: 6px;
    }
    .nav-links a::after {
      content: '';
      position: absolute;
      bottom: 2px;
      left: 12px;
      right: 12px;
      height: 2px;
      background: var(--gradient-fire);
      border-radius: 1px;
      transform: scaleX(0);
      transform-origin: right;
      transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .nav-links a:hover {
      color: var(--text-primary);
      background: rgba(220,38,38,0.06);
      transform: translateY(-3px);
    }
    .nav-links a:hover::after { transform: scaleX(1); transform-origin: left; }
    .nav-links a.active {
      color: var(--red);
      font-weight: 600;
      background: rgba(220,38,38,0.08);
    }
    .nav-links a.active::after {
      transform: scaleX(1);
      transform-origin: left;
    }
    .nav-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 500;
      color: var(--text-muted);
    }
    .nav-status .dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: var(--green);
      box-shadow: 0 0 8px var(--green);
      animation: pulse-dot 2s ease-in-out infinite;
    }
    .nav-status .dot.offline { background: var(--red); box-shadow: 0 0 8px var(--red); animation: none; }
    .nav-socials {
      position: fixed;
      right: 48px;
      top: 0;
      height: 56px;
      display: flex;
      align-items: center;
      gap: 6px;
      z-index: 101;
    }
    .nav-socials a {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 34px;
      height: 34px;
      border-radius: 8px;
      color: var(--text-dim);
      background: rgba(0,0,0,0.03);
      border: 1px solid rgba(0,0,0,0.06);
      transition: all 0.25s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .nav-socials a:hover {
      transform: translateY(-3px) scale(1.1);
      box-shadow: 0 6px 16px rgba(0,0,0,0.12);
    }
    .nav-socials a:active {
      transform: translateY(0) scale(0.95);
    }
    .nav-socials a.social-pump:hover { color: #00d18c; background: rgba(0,209,140,0.1); border-color: rgba(0,209,140,0.25); }
    .nav-socials a.social-x:hover { color: #000; background: rgba(0,0,0,0.06); border-color: rgba(0,0,0,0.15); }
    .nav-socials a.social-github:hover { color: #333; background: rgba(0,0,0,0.06); border-color: rgba(0,0,0,0.15); }
    .nav-socials a.social-medium:hover { color: #000; background: rgba(0,0,0,0.06); border-color: rgba(0,0,0,0.15); }
    .nav-socials svg { width: 16px; height: 16px; }
    .nav-socials img { width: 18px; height: 18px; object-fit: contain; }
    @keyframes pulse-dot {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(0.85); }
    }

    /* CA Button */
    .ca-btn {
      position: absolute;
      top: 96px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 99;
      display: inline-flex;
      align-items: center;
      border-radius: 10px;
      overflow: hidden;
      min-width: 480px;
      border: 1px solid var(--border);
      background: var(--bg-secondary);
      box-shadow: var(--shadow-sm);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .ca-btn:hover {
      border-color: var(--border-hover);
      box-shadow: var(--shadow-md);
      transform: translateX(-50%) translateY(-1px);
    }
    .ca-btn-label {
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 600;
      color: var(--red);
      padding: 7px 10px;
      background: var(--bg-surface);
      border-right: 1px solid var(--border);
    }
    .ca-btn-value {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 7px 14px;
      flex: 1;
      background: transparent;
      border: none;
      font-family: var(--font-mono);
      font-size: 11.5px;
      font-weight: 500;
      color: var(--text-primary);
      cursor: pointer;
    }
    .ca-btn-value svg {
      width: 12px;
      height: 12px;
      color: var(--text-muted);
      flex-shrink: 0;
    }
    .ca-btn:hover .ca-btn-value svg { color: var(--red); }
    .ca-btn.copied .ca-btn-value { color: var(--green); }
    .ca-btn.copied .ca-btn-value svg { color: var(--green); }

    /* ═══════════════════════════════════════════
       HERO
       ═══════════════════════════════════════════ */
    #hero {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 120px 24px 80px;
      position: relative;
      z-index: 1;
      background: linear-gradient(180deg, #FFFFFF 0%, #FFF8F8 40%, rgba(220,38,38,0.06) 70%, var(--bg-primary) 100%);
    }
    /* Giant faded pokeball watermark */
    .hero-pokeball-bg {
      position: absolute;
      width: 800px;
      height: 800px;
      opacity: 0.18;
      pointer-events: none;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    .hero-overline {
      font-family: var(--font-mono);
      font-size: 13px;
      font-weight: 500;
      color: var(--text-muted);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .live-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      background: rgba(34,197,94,0.1);
      border: 1px solid rgba(34,197,94,0.2);
      border-radius: 100px;
      color: var(--green);
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.08em;
    }
    .live-chip.offline-chip {
      background: rgba(220,38,38,0.1);
      border-color: rgba(220,38,38,0.2);
      color: var(--red);
    }
    .live-chip .dot {
      width: 6px; height: 6px;
      border-radius: 50%;
      background: var(--green);
      animation: pulse-dot 2s ease-in-out infinite;
    }
    .live-chip.offline-chip .dot { background: var(--red); animation: none; }
    .hero-title { margin-bottom: 24px; }
    .hero-subtitle {
      font-size: clamp(17px, 2.5vw, 20px);
      color: var(--text-secondary);
      line-height: 1.7;
      max-width: 660px;
      margin: 0 auto 48px;
      font-weight: 400;
    }
    .hero-subtitle strong { color: var(--text-primary); font-weight: 600; }
    .hero-metrics {
      display: flex;
      gap: 1px;
      background: rgba(220,38,38,0.1);
      border-radius: var(--radius-md);
      overflow: hidden;
      margin-bottom: 64px;
      position: relative;
      box-shadow: var(--shadow-md);
    }
    .hero-metrics::before {
      content: '';
      position: absolute;
      inset: -1px;
      border-radius: var(--radius-md);
      padding: 1px;
      background: linear-gradient(135deg, rgba(220,38,38,0.5), rgba(249,115,22,0.4), rgba(234,179,8,0.3));
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events: none;
      z-index: 1;
    }
    .hero-metric {
      background: #FFFFFF;
      padding: 20px 32px;
      text-align: center;
      min-width: 140px;
      transition: all var(--transition-base);
    }
    .hero-metric:hover { background: #FFF0EC; transform: translateY(-2px); }
    .hero-metric-value {
      font-family: var(--font-mono);
      font-size: 22px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
      transition: all var(--transition-base);
    }
    .hero-metric:hover .hero-metric-value { color: var(--red); transform: scale(1.1); text-shadow: 0 0 16px rgba(220,38,38,0.2); }
    .hero-metric-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
    }
    .hero-scroll {
      position: absolute;
      bottom: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      color: var(--text-dim);
      font-size: 11px;
      font-weight: 500;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      animation: float-gentle 3s ease-in-out infinite;
    }
    .hero-scroll-line {
      width: 1px;
      height: 40px;
      background: linear-gradient(to bottom, rgba(220,38,38,0.3), transparent);
    }
    @keyframes float-gentle {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(8px); }
    }

    /* ═══════════════════════════════════════════
       SECTION COLORED BACKGROUNDS
       ═══════════════════════════════════════════ */
    #about::before, #mind::before, #team::before, #pokedex::before,
    #journey::before, #stats::before, #highlights::before, #architecture::before {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: -1;
    }
    #about::before { background: radial-gradient(ellipse at 20% 50%, rgba(75,141,248,0.07) 0%, transparent 70%); }
    #mind::before { background: radial-gradient(ellipse at 80% 30%, rgba(155,111,246,0.06) 0%, transparent 70%); }
    #highlights::before { background: radial-gradient(ellipse at 50% 50%, rgba(247,169,11,0.05) 0%, transparent 70%); }
    #team::before { background: radial-gradient(ellipse at 30% 60%, rgba(229,53,53,0.06) 0%, transparent 70%); }
    #pokedex::before { background: radial-gradient(ellipse at 70% 40%, rgba(52,211,104,0.06) 0%, transparent 70%); }
    #journey::before { background: radial-gradient(ellipse at 20% 40%, rgba(247,169,11,0.06) 0%, transparent 70%); }
    #stats::before { background: radial-gradient(ellipse at 60% 50%, rgba(251,140,45,0.06) 0%, transparent 70%); }
    #architecture::before { background: radial-gradient(ellipse at 40% 60%, rgba(16,200,222,0.05) 0%, transparent 70%); }
    /* Floating pokeball accent on select sections */
    #team::after, #journey::after {
      content: '';
      position: absolute;
      width: 200px; height: 200px;
      border-radius: 50%;
      border: 3px solid rgba(229,53,53,0.04);
      pointer-events: none;
      z-index: -1;
    }
    #team::after { top: 40px; right: -60px; }
    #journey::after { bottom: 60px; left: -80px; }

    /* ═══════════════════════════════════════════
       ABOUT SECTION
       ═══════════════════════════════════════════ */
    #about { z-index: 1; }
    .about-intro {
      font-size: 19px;
      line-height: 1.8;
      color: var(--text-secondary);
      max-width: 720px;
      margin-top: 20px;
      margin-bottom: 56px;
    }
    .about-intro strong { color: var(--text-primary); font-weight: 600; }
    .about-highlight {
      display: inline;
      background: var(--gradient-fire-subtle);
      padding: 2px 6px;
      border-radius: 4px;
      color: var(--orange);
      font-weight: 600;
    }
    .features-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }
    .feature-card {
      padding: 32px 28px;
      position: relative;
      background: color-mix(in srgb, var(--feature-color, var(--red)) 4%, var(--bg-surface-alt));
      border-left: 2px solid color-mix(in srgb, var(--feature-color, var(--red)) 20%, transparent);
    }
    .feature-card:hover {
      background: color-mix(in srgb, var(--feature-color, var(--red)) 10%, var(--bg-surface-alt));
      border-left-color: color-mix(in srgb, var(--feature-color, var(--red)) 60%, transparent);
      border-left-width: 3px;
    }
    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -2px;
      right: 0;
      height: 3px;
      border-radius: 0 1px 1px 0;
      background: var(--feature-color, var(--red));
      opacity: 0.6;
      transition: opacity var(--transition-base);
    }
    .feature-card:hover::before { opacity: 1; }
    .feature-icon {
      width: 44px;
      height: 44px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      background: color-mix(in srgb, var(--feature-color, var(--red)) 10%, transparent);
      border: 1px solid color-mix(in srgb, var(--feature-color, var(--red)) 15%, transparent);
    }
    .feature-card:hover .feature-icon {
      animation: icon-wiggle 0.5s ease;
      background: color-mix(in srgb, var(--feature-color, var(--red)) 20%, transparent);
      border-color: color-mix(in srgb, var(--feature-color, var(--red)) 30%, transparent);
    }
    .feature-icon img {
      width: 28px;
      height: 28px;
      image-rendering: pixelated;
    }
    .feature-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    .feature-desc {
      font-size: 14px;
      line-height: 1.65;
      color: var(--text-secondary);
    }

    /* ═══════════════════════════════════════════
       HIGHLIGHTS / MILESTONES
       ═══════════════════════════════════════════ */
    #highlights { z-index: 1; }
    .highlights-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 16px;
      margin-top: 40px;
    }
    .highlight-card {
      padding: 24px;
      display: flex;
      align-items: flex-start;
      gap: 16px;
      position: relative;
      overflow: hidden;
      background: color-mix(in srgb, var(--hl-color, var(--gold)) 4%, var(--bg-surface-alt));
      border-left: 2px solid color-mix(in srgb, var(--hl-color, var(--gold)) 20%, transparent);
    }
    .highlight-card:hover {
      background: color-mix(in srgb, var(--hl-color, var(--gold)) 8%, var(--bg-surface-alt));
      border-left-color: color-mix(in srgb, var(--hl-color, var(--gold)) 40%, transparent);
    }
    .highlight-card::before {
      content: '';
      position: absolute;
      top: 0; left: -2px; right: 0;
      height: 3px;
      background: var(--hl-color, var(--gold));
      opacity: 0.7;
      transition: opacity var(--transition-base);
    }
    .highlight-card:hover::before { opacity: 1; height: 4px; }
    .highlight-icon {
      width: 44px; height: 44px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      background: color-mix(in srgb, var(--hl-color, var(--gold)) 10%, transparent);
      border: 1px solid color-mix(in srgb, var(--hl-color, var(--gold)) 15%, transparent);
    }
    .highlight-icon img {
      width: 28px;
      height: 28px;
      image-rendering: pixelated;
    }
    .highlight-info { flex: 1; min-width: 0; }
    .highlight-title {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }
    .highlight-desc {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.5;
    }
    .highlight-card.locked {
      opacity: 0.35;
      filter: grayscale(0.6);
    }
    .highlight-card.locked:hover {
      opacity: 0.55;
      filter: grayscale(0.3);
    }
    .highlight-card.unlocked .highlight-icon {
      animation: highlight-pop 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .highlight-card.unlocked:hover .highlight-icon { animation: icon-wiggle 0.5s ease; }
    @keyframes highlight-pop {
      0% { transform: scale(0.8); }
      50% { transform: scale(1.15); }
      100% { transform: scale(1); }
    }

    /* ═══════════════════════════════════════════
       LOCATION STRIP
       ═══════════════════════════════════════════ */
    .location-strip {
      background: linear-gradient(135deg, rgba(229,53,53,0.04), var(--bg-secondary), rgba(251,140,45,0.03));
      border-top: 1px solid rgba(229,53,53,0.15);
      border-bottom: 1px solid rgba(229,53,53,0.15);
      padding: 18px 0;
      position: relative;
      z-index: 1;
    }
    .location-inner {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 24px;
      flex-wrap: wrap;
    }
    .location-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
    }
    .location-item .label { color: var(--text-muted); font-weight: 500; }
    .location-item .value { color: var(--text-primary); font-weight: 600; font-family: var(--font-mono); font-size: 12px; }
    .phase-badge {
      display: inline-flex;
      align-items: center;
      padding: 5px 16px;
      border-radius: 100px;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.04em;
    }
    .phase-badge.overworld { background: rgba(34,197,94,0.1); color: var(--green); border: 1px solid rgba(34,197,94,0.2); }
    .phase-badge.battle { background: rgba(220,38,38,0.1); color: var(--red-light); border: 1px solid rgba(220,38,38,0.2); }
    .phase-badge.dialogue { background: rgba(59,130,246,0.1); color: var(--blue); border: 1px solid rgba(59,130,246,0.2); }
    .phase-badge.menu { background: rgba(139,92,246,0.1); color: var(--purple); border: 1px solid rgba(139,92,246,0.2); }
    .phase-badge.title { background: rgba(249,115,22,0.1); color: var(--orange); border: 1px solid rgba(249,115,22,0.2); }
    .phase-badge.transition { background: rgba(245,158,11,0.1); color: var(--gold); border: 1px solid rgba(245,158,11,0.2); }
    .phase-badge { transition: all var(--transition-fast); cursor: default; }
    .phase-badge:hover { transform: scale(1.08) translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
    .location-item { transition: all var(--transition-fast); }
    .location-item:hover { transform: translateY(-2px); }
    .location-item .value { transition: color var(--transition-fast); }
    .location-item:hover .value { color: var(--red); }
    .location-sep { color: var(--text-dim); }

    /* ═══════════════════════════════════════════
       AI MIND
       ═══════════════════════════════════════════ */
    #mind { z-index: 1; }
    .mind-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto auto;
      gap: 20px;
      margin-top: 48px;
    }

    /* Game Frame — GBA-styled screen */
    .game-frame {
      grid-row: 1 / 3;
      position: relative;
      border-radius: var(--radius-lg);
      overflow: hidden;
      background: #08080c;
      border: 2px solid rgba(229,53,53,0.3);
      aspect-ratio: 3 / 2;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: inset 0 2px 20px rgba(0,0,0,0.5), 0 0 40px rgba(220,38,38,0.06);
      transition: border-color var(--transition-base), box-shadow var(--transition-base);
    }
    .game-frame:hover {
      border-color: rgba(220,38,38,0.25);
      box-shadow: inset 0 2px 20px rgba(0,0,0,0.5), 0 0 60px rgba(220,38,38,0.1);
    }
    .game-frame img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      image-rendering: pixelated;
    }
    /* Scanline overlay */
    .game-frame::after {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0,0,0,0.04) 2px,
        rgba(0,0,0,0.04) 4px
      );
      pointer-events: none;
      z-index: 2;
    }
    .game-frame-live {
      position: absolute;
      top: 12px;
      left: 12px;
      z-index: 3;
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 100px;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(8px);
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--green);
    }
    .game-frame-live .dot {
      width: 5px; height: 5px;
      border-radius: 50%;
      background: var(--green);
      animation: pulse-dot 2s ease-in-out infinite;
    }
    .game-frame-res {
      position: absolute;
      bottom: 12px;
      right: 12px;
      z-index: 3;
      padding: 3px 8px;
      border-radius: 4px;
      background: rgba(0,0,0,0.6);
      font-family: var(--font-mono);
      font-size: 9px;
      font-weight: 600;
      color: var(--text-dim);
      letter-spacing: 0.04em;
    }
    /* Placeholder state */
    .game-frame-placeholder {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 16px;
      padding: 24px;
      text-align: center;
    }
    .game-frame-placeholder svg { opacity: 0.08; }
    .game-frame-placeholder-text {
      font-size: 13px;
      color: var(--text-dim);
      font-weight: 500;
    }
    .game-frame-placeholder-sub {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--text-dim);
      opacity: 0.6;
    }
    /* Grid cells for right column */
    .mind-observe-card { grid-column: 2; grid-row: 1; }
    .mind-reason-card  { grid-column: 2; grid-row: 2; }
    .mind-bottom-row {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 20px;
    }
    .mind-card { padding: 28px; }
    .mind-card-label {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 16px;
    }
    .mind-card-label .indicator { width: 8px; height: 8px; border-radius: 50%; }
    .mind-card-label.observe { color: var(--blue); }
    .mind-card-label.observe .indicator { background: var(--blue); box-shadow: 0 0 10px var(--blue); }
    .mind-card-label.reason { color: var(--purple); }
    .mind-card-label.reason .indicator { background: var(--purple); box-shadow: 0 0 10px var(--purple); }
    .mind-card-label.act { color: var(--green); }
    .mind-card-label.act .indicator { background: var(--green); box-shadow: 0 0 10px var(--green); }
    .mind-card-label.plan { color: var(--orange); }
    .mind-card-label.plan .indicator { background: var(--orange); box-shadow: 0 0 10px var(--orange); }
    .mind-card-text { font-size: 15px; line-height: 1.7; color: var(--text-secondary); }
    .mind-card-hero .mind-card-text { font-size: 17px; }
    .mind-action-display {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 22px;
      background: rgba(34,197,94,0.08);
      border: 1px solid rgba(34,197,94,0.2);
      border-radius: var(--radius-sm);
      margin-top: 8px;
    }
    .mind-action-key { font-family: var(--font-mono); font-size: 20px; font-weight: 700; color: var(--green); }
    .mind-action-detail { font-size: 13px; color: var(--text-secondary); }
    .mind-pipeline {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin: 48px 0 32px;
    }
    .mind-pipeline-step {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      transition: all var(--transition-fast);
      cursor: default;
    }
    .mind-pipeline-step:hover { transform: scale(1.1) translateY(-2px); }
    .mind-pipeline-step .step-dot { width: 6px; height: 6px; border-radius: 50%; transition: all var(--transition-fast); }
    .mind-pipeline-step:hover .step-dot { transform: scale(1.5); box-shadow: 0 0 8px currentColor; }
    .mind-pipeline-arrow { color: var(--text-dim); font-size: 14px; }

    /* ═══════════════════════════════════════════
       BATTLE MODE
       ═══════════════════════════════════════════ */
    @keyframes battle-pulse {
      0%, 100% { box-shadow: inset 0 2px 20px rgba(0,0,0,0.5), 0 0 40px rgba(220,38,38,0.06); }
      50% { box-shadow: inset 0 2px 20px rgba(0,0,0,0.5), 0 0 80px rgba(220,38,38,0.25); }
    }
    @keyframes battle-glow {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }
    @keyframes battle-border-pulse {
      0%, 100% { border-color: rgba(220,38,38,0.15); }
      50% { border-color: rgba(220,38,38,0.4); }
    }
    body.battle-active .game-frame {
      border-color: rgba(220,38,38,0.4);
      animation: battle-pulse 2s ease-in-out infinite;
    }
    body.battle-active .location-strip {
      border-color: rgba(220,38,38,0.15);
      background: linear-gradient(180deg, rgba(220,38,38,0.04), var(--bg-secondary));
    }
    body.battle-active .phase-badge.battle {
      animation: battle-glow 1.5s ease-in-out infinite;
    }
    .battle-overlay {
      display: none;
      grid-column: 1 / -1;
      padding: 0;
      overflow: hidden;
    }
    body.battle-active .battle-overlay { display: block; }
    .battle-banner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      background: linear-gradient(135deg, rgba(220,38,38,0.1), rgba(220,38,38,0.03));
      border-bottom: 1px solid rgba(220,38,38,0.1);
    }
    .battle-banner-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 13px;
      font-weight: 700;
      color: var(--red-light);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    .battle-banner-title .dot {
      width: 8px; height: 8px;
      border-radius: 50%;
      background: var(--red-light);
      animation: battle-glow 1.5s ease-in-out infinite;
    }
    .battle-banner-type {
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 600;
      color: var(--orange);
    }
    .battle-stats-row {
      display: flex;
      gap: 24px;
      padding: 16px 24px;
      flex-wrap: wrap;
    }
    .battle-stat-item {
      font-family: var(--font-mono);
      font-size: 12px;
      color: var(--text-muted);
      transition: all var(--transition-fast);
    }
    .battle-stat-item:hover { transform: translateY(-2px); }
    .battle-stat-item .val {
      color: var(--text-primary);
      font-weight: 700;
      transition: color var(--transition-fast);
    }
    .battle-stat-item:hover .val { color: var(--red); }

    /* ═══════════════════════════════════════════
       TEAM
       ═══════════════════════════════════════════ */
    #team { z-index: 1; }
    .team-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-top: 48px;
    }
    .poke-card {
      padding: 28px 24px;
      text-align: center;
      transition: all var(--transition-base);
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, color-mix(in srgb, var(--type-color, #A8A878) 5%, transparent), transparent 60%);
      border-left: 2px solid color-mix(in srgb, var(--type-color, #A8A878) 20%, transparent);
    }
    .poke-card:hover {
      border-left-color: color-mix(in srgb, var(--type-color, #A8A878) 60%, transparent);
      border-left-width: 3px;
      background: linear-gradient(180deg, color-mix(in srgb, var(--type-color, #A8A878) 10%, transparent), transparent 60%);
    }
    /* Type-colored top accent */
    .poke-card .type-accent {
      position: absolute;
      top: 0; left: -2px; right: 0;
      height: 4px;
      background: var(--type-color, var(--red));
      opacity: 0.8;
      transition: opacity var(--transition-base);
    }
    .poke-card:hover .type-accent { opacity: 1; }
    .poke-card.empty { opacity: 0.3; border-style: dashed; }
    .poke-card.empty:hover { transform: none; box-shadow: none; }
    .poke-sprite {
      width: 96px;
      height: 96px;
      margin: 0 auto 12px;
      image-rendering: pixelated;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.15));
      transition: transform var(--transition-base);
    }
    .poke-card:hover .poke-sprite { transform: scale(1.15) translateY(-6px); filter: drop-shadow(0 8px 20px rgba(0,0,0,0.2)); }
    .poke-name { font-size: 16px; font-weight: 700; color: var(--text-primary); margin-bottom: 4px; text-transform: capitalize; }
    .poke-level { font-family: var(--font-mono); font-size: 12px; font-weight: 600; color: var(--text-muted); margin-bottom: 6px; }
    .poke-type-badge {
      display: inline-block;
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      padding: 2px 10px;
      border-radius: 100px;
      margin-bottom: 12px;
      color: #fff;
      background: var(--type-color, #666);
      transition: all var(--transition-fast);
    }
    .poke-type-badge:hover { transform: scale(1.1) translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .hp-bar-container {
      width: 100%;
      height: 6px;
      background: rgba(0,0,0,0.06);
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 6px;
    }
    .hp-bar-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .hp-bar-fill.hp-high { background: var(--green); }
    .hp-bar-fill.hp-mid { background: var(--gold); }
    .hp-bar-fill.hp-low { background: var(--red); }
    .hp-text { font-family: var(--font-mono); font-size: 11px; color: var(--text-muted); margin-bottom: 14px; }
    .poke-moves { display: flex; flex-wrap: wrap; gap: 4px; justify-content: center; }
    .poke-move {
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 500;
      padding: 3px 8px;
      border-radius: var(--radius-xs);
      background: rgba(0,0,0,0.03);
      border: 1px solid rgba(0,0,0,0.06);
      color: var(--text-secondary);
      text-transform: capitalize;
      transition: all var(--transition-fast);
    }
    .poke-move:hover { transform: scale(1.08) translateY(-2px); background: rgba(220,38,38,0.06); border-color: rgba(220,38,38,0.15); color: var(--text-primary); box-shadow: 0 3px 8px rgba(0,0,0,0.06); }
    .poke-empty-label { color: var(--text-dim); font-size: 13px; font-weight: 500; }

    /* ═══════════════════════════════════════════
       BADGES
       ═══════════════════════════════════════════ */
    .badges-section { margin-top: 56px; }
    .badges-row {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-top: 16px;
      flex-wrap: wrap;
    }
    .gym-badge {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 2px solid rgba(0,0,0,0.08);
      background: rgba(0,0,0,0.02);
      transition: all var(--transition-base);
      cursor: pointer;
    }
    .gym-badge:not(.earned):hover {
      transform: scale(1.1) translateY(-3px);
      border-color: rgba(0,0,0,0.15);
      background: rgba(0,0,0,0.05);
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    }
    .gym-badge.earned {
      border-color: var(--badge-color);
      background: color-mix(in srgb, var(--badge-color) 18%, transparent);
      box-shadow: 0 0 30px color-mix(in srgb, var(--badge-color) 30%, transparent);
      position: relative;
      overflow: hidden;
    }
    .gym-badge.earned::after {
      content: '';
      position: absolute;
      inset: -50%;
      border-radius: 50%;
      background: radial-gradient(circle, color-mix(in srgb, var(--badge-color) 40%, white) 0%, transparent 70%);
      opacity: 0;
      pointer-events: none;
    }
    .gym-badge.earned:hover {
      transform: scale(1.2) translateY(-4px);
      box-shadow: 0 0 50px color-mix(in srgb, var(--badge-color) 55%, transparent), 0 8px 24px rgba(0,0,0,0.1);
    }
    .gym-badge.earned:hover::after { animation: badge-gleam 0.7s ease forwards; }
    .gym-badge-icon {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-base);
    }
    .gym-badge-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: none;
      transition: filter var(--transition-base);
    }
    .gym-badge.earned .gym-badge-icon img { filter: none; }
    .gym-badge-name {
      font-size: 8px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-dim);
      margin-top: 3px;
    }
    .gym-badge.earned .gym-badge-name { color: var(--badge-color); }
    .gym-badge-type {
      font-size: 7px;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.04em;
      margin-top: 1px;
    }
    .gym-badge.earned .gym-badge-type { color: color-mix(in srgb, var(--badge-color) 70%, white); }

    /* ═══════════════════════════════════════════
       POKEDEX
       ═══════════════════════════════════════════ */
    #pokedex { z-index: 1; }
    .pokedex-header-stats {
      display: flex;
      gap: 24px;
      margin-top: 16px;
      margin-bottom: 32px;
    }
    .pokedex-stat {
      font-family: var(--font-mono);
      font-size: 13px;
      color: var(--text-muted);
      transition: all var(--transition-fast);
    }
    .pokedex-stat:hover { transform: translateY(-2px); color: var(--text-primary); }
    .pokedex-stat .val {
      color: var(--text-primary);
      font-weight: 700;
      transition: color var(--transition-fast);
    }
    .pokedex-stat:hover .val { color: var(--red); }
    .pokedex-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(56px, 1fr));
      gap: 4px;
    }
    .dex-cell {
      aspect-ratio: 1;
      border-radius: var(--radius-xs);
      background: rgba(0,0,0,0.02);
      border: 1px solid rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      transition: all var(--transition-fast);
      cursor: pointer;
      overflow: hidden;
    }
    .dex-cell:hover {
      background: rgba(220,38,38,0.05);
      border-color: rgba(220,38,38,0.2);
      transform: scale(1.15) translateY(-3px);
      z-index: 2;
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
    }
    .dex-cell .dex-num {
      font-family: var(--font-mono);
      font-size: 8px;
      color: var(--text-dim);
      font-weight: 600;
    }
    .dex-cell .dex-sprite {
      width: 32px; height: 32px;
      image-rendering: pixelated;
      filter: brightness(0) saturate(0);
      opacity: 0.12;
      transition: all var(--transition-base);
    }
    .dex-cell.seen {
      background: rgba(0,0,0,0.02);
      border-color: rgba(0,0,0,0.1);
    }
    .dex-cell.seen .dex-sprite {
      filter: grayscale(0.5);
      opacity: 0.6;
    }
    .dex-cell.seen .dex-num {
      color: var(--text-dim);
    }
    .dex-cell.caught {
      background: color-mix(in srgb, var(--type-color, #A8A878) 8%, transparent);
      border-color: color-mix(in srgb, var(--type-color, #A8A878) 20%, transparent);
    }
    .dex-cell.caught .dex-sprite {
      filter: none;
      opacity: 1;
    }
    .dex-cell.caught .dex-num {
      color: var(--type-color, var(--text-secondary));
    }
    .dex-cell.caught:hover {
      box-shadow: 0 0 16px color-mix(in srgb, var(--type-color, #A8A878) 25%, transparent);
      border-color: var(--type-color, #A8A878);
    }
    .dex-cell-tooltip {
      position: absolute;
      bottom: calc(100% + 6px);
      left: 50%;
      transform: translateX(-50%);
      padding: 4px 10px;
      background: rgba(26,26,46,0.92);
      border: 1px solid rgba(220,38,38,0.3);
      border-radius: var(--radius-xs);
      font-size: 10px;
      font-weight: 600;
      color: #FFFFFF;
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transition: opacity var(--transition-fast);
      z-index: 10;
      text-transform: capitalize;
    }
    .dex-cell:hover .dex-cell-tooltip { opacity: 1; }

    /* Pokedex Detail Modal */
    .dex-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(4px);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
    }
    .dex-modal-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }
    .dex-modal {
      background: #ffffff;
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: var(--radius-lg, 12px);
      width: 340px;
      max-width: 90vw;
      box-shadow: 0 24px 48px rgba(0,0,0,0.3);
      overflow: hidden;
      transform: scale(0.9) translateY(20px);
      transition: transform 0.25s ease;
    }
    .dex-modal-overlay.active .dex-modal {
      transform: scale(1) translateY(0);
    }
    .dex-modal-header {
      padding: 20px 24px 12px;
      display: flex;
      align-items: center;
      gap: 16px;
      border-bottom: 1px solid rgba(0,0,0,0.08);
      position: relative;
    }
    .dex-modal-sprite {
      width: 80px;
      height: 80px;
      image-rendering: pixelated;
      background: #f5f5f8;
      border-radius: var(--radius-sm, 8px);
      padding: 8px;
    }
    .dex-modal-info { flex: 1; }
    .dex-modal-name {
      font-size: 20px;
      font-weight: 700;
      color: #1a1a2e;
      text-transform: capitalize;
      margin: 0;
    }
    .dex-modal-number {
      font-family: var(--font-mono);
      font-size: 12px;
      color: #888;
      margin-bottom: 6px;
    }
    .dex-modal-types {
      display: flex;
      gap: 6px;
      margin-top: 6px;
    }
    .dex-modal-type-badge {
      padding: 2px 10px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      color: #fff;
      text-transform: capitalize;
      letter-spacing: 0.5px;
    }
    .dex-modal-body {
      padding: 16px 24px 20px;
    }
    .dex-modal-flavor {
      font-size: 13px;
      line-height: 1.6;
      color: #555;
      font-style: italic;
      margin: 0 0 12px;
      min-height: 40px;
    }
    .dex-modal-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    .dex-modal-stat {
      font-size: 12px;
      color: #777;
    }
    .dex-modal-stat span {
      font-weight: 600;
      color: #1a1a2e;
    }
    .dex-modal-close {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 28px;
      height: 28px;
      border: none;
      background: rgba(0,0,0,0.05);
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #999;
      font-size: 16px;
      transition: background var(--transition-fast);
    }
    .dex-modal-close:hover {
      background: rgba(0,0,0,0.1);
      color: #333;
    }
    .dex-modal-loading {
      text-align: center;
      padding: 20px;
      color: var(--text-dim);
      font-size: 13px;
    }

    /* ═══════════════════════════════════════════
       JOURNEY
       ═══════════════════════════════════════════ */
    #journey { z-index: 1; }
    .journey-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }
    .journey-progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(229,53,53,0.08);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 40px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.06);
    }
    .journey-progress-fill {
      height: 100%;
      background: var(--gradient-fire);
      border-radius: 3px;
      transition: width 1s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .journey-progress-text {
      font-family: var(--font-mono);
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }
    .journey-timeline {
      position: relative;
      padding-left: 28px;
    }
    .journey-timeline::before {
      content: '';
      position: absolute;
      left: 5px; top: 0; bottom: 0;
      width: 2px;
      background: rgba(220,38,38,0.08);
      border-radius: 1px;
    }
    .journey-item {
      position: relative;
      padding: 10px 0 10px 24px;
      font-size: 14px;
      color: var(--text-muted);
    }
    .journey-item::before {
      content: '';
      position: absolute;
      left: -24px; top: 16px;
      width: 12px; height: 12px;
      border-radius: 50%;
      border: 2px solid rgba(0,0,0,0.1);
      background: var(--bg-primary);
    }
    .journey-item.completed { color: var(--text-secondary); }
    .journey-item.completed::before {
      background: var(--green);
      border-color: var(--green);
      box-shadow: 0 0 8px rgba(34,197,94,0.4);
    }
    .journey-item.active { color: var(--text-primary); font-weight: 600; }
    .journey-item.active::before {
      background: var(--red-light);
      border-color: var(--red-light);
      box-shadow: 0 0 10px rgba(220,38,38,0.5);
      animation: pulse-dot 2s ease-in-out infinite;
    }
    .journey-item.blocked::before { background: var(--text-dim); border-color: var(--text-dim); }
    .journey-item-status {
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-left: 8px;
      padding: 2px 8px;
      border-radius: 100px;
    }
    .journey-item.completed .journey-item-status { color: var(--green); background: rgba(34,197,94,0.1); }
    .journey-item.active .journey-item-status { color: var(--red-light); background: rgba(220,38,38,0.1); }
    .journey-item.blocked .journey-item-status { color: var(--text-muted); background: rgba(0,0,0,0.04); }

    /* ═══════════════════════════════════════════
       STATS
       ═══════════════════════════════════════════ */
    #stats { z-index: 1; }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-top: 48px;
    }
    .stat-card {
      padding: 28px; position: relative; overflow: hidden;
      background: linear-gradient(180deg, color-mix(in srgb, var(--stat-color, var(--red)) 5%, transparent), transparent 70%);
    }
    .stat-card::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 4px;
      background: var(--stat-color, var(--red));
      opacity: 0.6;
      transition: opacity var(--transition-base);
    }
    .stat-card:hover::after { opacity: 1; }
    .stat-value {
      font-family: var(--font-mono);
      font-size: 32px;
      font-weight: 800;
      color: var(--text-primary);
      margin-bottom: 4px;
      line-height: 1.2;
      transition: all var(--transition-base);
    }
    .stat-card:hover .stat-value {
      color: var(--stat-color, var(--red));
      text-shadow: 0 0 24px color-mix(in srgb, var(--stat-color, var(--red)) 40%, transparent);
      transform: scale(1.08);
      transform-origin: left;
    }
    .stat-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    /* ═══════════════════════════════════════════
       SESSIONS TABLE
       ═══════════════════════════════════════════ */
    .sessions-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 24px;
      font-size: 13px;
    }
    .sessions-table th {
      text-align: left;
      padding: 12px 16px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      border-bottom: 1px solid var(--border-alt);
    }
    .sessions-table td {
      padding: 14px 16px;
      border-bottom: 1px solid rgba(0,0,0,0.04);
      color: var(--text-secondary);
      font-family: var(--font-mono);
      font-size: 12px;
    }
    .sessions-table tr:hover td { background: rgba(220,38,38,0.05); transition: background var(--transition-fast); }
    .session-running { color: var(--green); font-weight: 600; }

    /* ═══════════════════════════════════════════
       ARCHITECTURE
       ═══════════════════════════════════════════ */
    #architecture { z-index: 1; }
    .arch-flow { margin-top: 48px; display: flex; flex-direction: column; gap: 24px; }
    .arch-row { display: flex; align-items: center; justify-content: center; gap: 8px; flex-wrap: wrap; }
    .arch-node {
      padding: 16px 24px;
      border-radius: var(--radius-md);
      background: var(--bg-surface-alt);
      border: 1px solid var(--border-alt);
      text-align: center;
      min-width: 130px;
      transition: all var(--transition-base);
      position: relative;
    }
    .arch-node:hover { border-color: var(--border-hover); transform: translateY(-2px); box-shadow: var(--shadow-glow); }
    .arch-node.data:hover { border-color: var(--blue); box-shadow: 0 8px 28px rgba(75,141,248,0.25); transform: translateY(-4px) scale(1.02); }
    .arch-node.ai:hover { border-color: var(--red-light); box-shadow: 0 8px 28px rgba(240,82,82,0.25); transform: translateY(-4px) scale(1.02); }
    .arch-node.output:hover { border-color: var(--green); box-shadow: 0 8px 28px rgba(52,211,104,0.25); transform: translateY(-4px) scale(1.02); }
    .arch-node.infra:hover { border-color: var(--orange); box-shadow: 0 8px 28px rgba(251,140,45,0.25); transform: translateY(-4px) scale(1.02); }
    .arch-node::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      border-radius: 1px 1px 0 0;
    }
    .arch-node.data { border-left: 2px solid rgba(75,141,248,0.2); }
    .arch-node.data::before { background: var(--blue); }
    .arch-node.ai { border-left: 2px solid rgba(240,82,82,0.2); }
    .arch-node.ai::before { background: var(--red-light); }
    .arch-node.output { border-left: 2px solid rgba(52,211,104,0.2); }
    .arch-node.output::before { background: var(--green); }
    .arch-node.infra { border-left: 2px solid rgba(251,140,45,0.2); }
    .arch-node.infra::before { background: var(--orange); }
    .arch-node-label { font-size: 13px; font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
    .arch-node-desc { font-size: 11px; color: var(--text-muted); }
    .arch-arrow { color: var(--text-dim); font-size: 18px; flex-shrink: 0; font-family: var(--font-mono); }
    .arch-arrow-down { display: flex; justify-content: center; color: var(--text-dim); font-size: 18px; font-family: var(--font-mono); }
    .arch-legend { display: flex; justify-content: center; gap: 24px; margin-top: 32px; flex-wrap: wrap; }
    .arch-legend-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--text-muted); transition: all var(--transition-fast); cursor: default; }
    .arch-legend-item:hover { transform: translateY(-2px); color: var(--text-primary); }
    .arch-legend-dot { width: 10px; height: 3px; border-radius: 2px; transition: all var(--transition-fast); }
    .arch-legend-item:hover .arch-legend-dot { transform: scaleX(1.5); }

    /* ═══════════════════════════════════════════
       TECH STACK
       ═══════════════════════════════════════════ */
    .tech-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 32px;
      justify-content: center;
    }
    .tech-badge {
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 600;
      padding: 8px 18px;
      border-radius: 100px;
      background: rgba(0,0,0,0.02);
      border: 1px solid rgba(0,0,0,0.06);
      color: var(--text-secondary);
      transition: all var(--transition-base);
    }
    .tech-badge:hover {
      background: rgba(220,38,38,0.08);
      border-color: rgba(220,38,38,0.25);
      color: var(--red);
      transform: scale(1.08) translateY(-3px);
      box-shadow: 0 6px 20px rgba(220,38,38,0.15);
    }
    .tech-badge:active { transform: scale(0.96); }

    /* ═══════════════════════════════════════════
       ACTION LOG
       ═══════════════════════════════════════════ */
    #log { z-index: 1; }
    .log-list { display: flex; flex-direction: column; gap: 2px; }
    .log-entry {
      display: grid;
      grid-template-columns: 72px 64px 1fr 80px;
      gap: 16px;
      align-items: center;
      padding: 12px 16px;
      border-radius: var(--radius-sm);
      transition: background var(--transition-fast);
      font-size: 13px;
    }
    .log-entry:hover { background: rgba(220,38,38,0.05); transform: translateX(4px); }
    .log-entry { transition: background var(--transition-fast), transform var(--transition-fast); }
    .log-tick { font-family: var(--font-mono); font-size: 11px; color: var(--text-dim); font-weight: 500; }
    .log-action {
      font-family: var(--font-mono); font-size: 12px; font-weight: 700;
      color: var(--text-primary); padding: 3px 10px;
      background: rgba(220,38,38,0.06); border-radius: var(--radius-xs); text-align: center;
    }
    .log-obs { color: var(--text-secondary); font-size: 13px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .log-phase { font-family: var(--font-mono); font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; text-align: right; color: var(--text-muted); }

    /* ═══════════════════════════════════════════
       FAQ
       ═══════════════════════════════════════════ */
    #faq { padding: 80px 24px; }
    .faq-grid {
      max-width: 800px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 40px;
    }
    .faq-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      overflow: hidden;
      transition: all 0.3s ease;
    }
    .faq-item:hover {
      border-color: var(--border-hover);
      box-shadow: var(--shadow-md);
    }
    .faq-item.open {
      border-color: rgba(220,38,38,0.3);
      box-shadow: var(--shadow-glow);
    }
    .faq-question {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 18px 24px;
      cursor: pointer;
      gap: 16px;
      user-select: none;
    }
    .faq-question:hover { background: var(--bg-surface); }
    .faq-q-text {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.4;
    }
    .faq-item.open .faq-q-text { color: var(--red); }
    .faq-toggle {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.3s ease;
      color: var(--text-muted);
      font-size: 14px;
      font-family: var(--font-mono);
    }
    .faq-item.open .faq-toggle {
      background: var(--red);
      border-color: var(--red);
      color: #fff;
      transform: rotate(45deg);
    }
    .faq-answer {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .faq-item.open .faq-answer {
      max-height: 300px;
    }
    .faq-a-text {
      padding: 0 24px 20px;
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.7;
      border-top: 1px solid var(--border);
      padding-top: 16px;
      margin: 0 24px;
      padding-left: 0;
      padding-right: 0;
    }
    .faq-a-text code {
      font-family: var(--font-mono);
      font-size: 12px;
      background: var(--bg-surface);
      padding: 2px 6px;
      border-radius: 4px;
      color: var(--red);
    }

    /* ═══════════════════════════════════════════
       FOOTER
       ═══════════════════════════════════════════ */
    footer {
      padding: 0;
      border-top: 1px solid var(--border);
      position: relative;
      z-index: 1;
      background: var(--bg-primary);
    }
    .footer-divider { padding: 0 48px; position: relative; z-index: 2; }
    .footer-inner {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      padding: 32px 0 28px;
      text-align: center;
    }
    .footer-brand-name {
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: var(--font-pokemon);
      font-size: 18px;
      font-weight: 400;
      letter-spacing: 0.04em;
      color: #FFCB05;
      text-shadow: -1px -1px 0 #2A75BB, 1px -1px 0 #2A75BB, -1px 1px 0 #2A75BB, 1px 1px 0 #2A75BB;
    }
    .footer-brand-name svg { width: 24px; height: 24px; }
    .footer-tagline { font-size: 13px; color: var(--text-muted); line-height: 1.6; max-width: 480px; }
    .footer-bottom {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      font-size: 12px;
      color: var(--text-dim);
      padding-top: 12px;
      border-top: 1px solid var(--border);
      width: 100%;
    }
    .footer-bottom-dot { display: inline-block; width: 3px; height: 3px; border-radius: 50%; background: var(--red); opacity: 0.4; }

    /* ═══════════════════════════════════════════
       ANIMATIONS
       ═══════════════════════════════════════════ */
    .reveal {
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.7s cubic-bezier(0.16, 1, 0.3, 1), transform 0.7s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .reveal.visible { opacity: 1; transform: translateY(0); }
    .reveal-delay-1 { transition-delay: 0.08s; }
    .reveal-delay-2 { transition-delay: 0.16s; }
    .reveal-delay-3 { transition-delay: 0.24s; }
    .reveal-delay-4 { transition-delay: 0.32s; }
    .reveal-delay-5 { transition-delay: 0.40s; }
    .reveal-delay-6 { transition-delay: 0.48s; }
    .hero-enter { opacity: 0; transform: translateY(20px); animation: hero-in 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    .hero-enter-1 { animation-delay: 0.15s; }
    .hero-enter-2 { animation-delay: 0.3s; }
    .hero-enter-3 { animation-delay: 0.45s; }
    .hero-enter-4 { animation-delay: 0.65s; }
    .hero-enter-5 { animation-delay: 0.85s; }
    @keyframes hero-in { to { opacity: 1; transform: translateY(0); } }
    .flash { animation: data-flash 0.6s ease; }
    @keyframes data-flash { 0% { background: rgba(220,38,38,0.06); } 100% { background: transparent; } }

    /* Enhanced Type Animations */
    .poke-card:not(.empty):hover {
      box-shadow: 0 12px 32px color-mix(in srgb, var(--type-color, #A8A878) 22%, transparent), 0 4px 16px rgba(0,0,0,0.06);
    }
    .pokeball-divider svg {
      transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .pokeball-divider:hover svg {
      animation: pokeball-bounce 0.5s ease forwards;
    }
    .poke-type-badge {
      transition: all var(--transition-fast);
      position: relative;
      overflow: hidden;
    }
    .poke-type-badge::after {
      content: '';
      position: absolute;
      top: 0; left: -100%; width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.4s ease;
    }
    .poke-card:hover .poke-type-badge::after { left: 100%; }
    /* Type-colored glow on feature cards */
    .feature-card:hover {
      box-shadow: 0 12px 32px color-mix(in srgb, var(--feature-color, var(--red)) 18%, transparent), 0 4px 16px rgba(0,0,0,0.06);
    }
    /* Stat card glow */
    .stat-card:hover {
      box-shadow: 0 12px 32px color-mix(in srgb, var(--stat-color, var(--red)) 25%, transparent), 0 4px 16px rgba(0,0,0,0.06);
    }
    /* Badge earned pulse on hover */
    .gym-badge.earned:hover .gym-badge-icon {
      animation: badge-shine 0.6s ease;
    }
    @keyframes badge-shine {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    /* Hero pokeball slow rotation */
    .hero-pokeball-bg {
      animation: hero-pokeball-rotate 60s linear infinite;
    }
    @keyframes hero-pokeball-rotate {
      from { transform: translate(-50%, -50%) rotate(0deg); }
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }
    @keyframes card-shimmer-sweep {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    @keyframes icon-wiggle {
      0%, 100% { transform: rotate(0deg); }
      20% { transform: rotate(-8deg); }
      40% { transform: rotate(8deg); }
      60% { transform: rotate(-4deg); }
      80% { transform: rotate(4deg); }
    }
    @keyframes badge-gleam {
      0% { opacity: 0; transform: scale(0.5); }
      50% { opacity: 0.6; }
      100% { opacity: 0; transform: scale(1.5); }
    }
    @keyframes pokeball-bounce {
      0% { transform: rotate(0deg) translateY(0); opacity: 0.4; }
      30% { transform: rotate(120deg) translateY(-5px); opacity: 0.55; }
      60% { transform: rotate(160deg) translateY(-2px); opacity: 0.5; }
      100% { transform: rotate(180deg) translateY(0); opacity: 0.5; }
    }

    /* ═══════════════════════════════════════════
       AMBIENT GLOW
       ═══════════════════════════════════════════ */
    .ambient-glow {
      position: fixed;
      width: 700px; height: 700px;
      border-radius: 50%;
      filter: blur(160px);
      opacity: 0.05;
      pointer-events: none;
      z-index: 0;
    }
    .ambient-glow-1 { top: -200px; right: -100px; background: var(--red); animation: gd1 20s ease-in-out infinite alternate; }
    .ambient-glow-2 { bottom: 30%; left: -200px; background: var(--orange); animation: gd2 25s ease-in-out infinite alternate; }
    .ambient-glow-3 { bottom: -100px; right: 20%; background: var(--gold); opacity: 0.035; animation: gd3 30s ease-in-out infinite alternate; }
    .ambient-glow-4 { top: 40%; right: -150px; background: var(--blue); opacity: 0.03; animation: gd1 35s ease-in-out infinite alternate-reverse; }
    @keyframes gd1 { 0% { transform: translate(0,0); } 100% { transform: translate(-60px,40px); } }
    @keyframes gd2 { 0% { transform: translate(0,0); } 100% { transform: translate(40px,-30px); } }
    @keyframes gd3 { 0% { transform: translate(0,0); } 100% { transform: translate(-30px,-50px); } }

    /* ═══════════════════════════════════════════
       UNIVERSAL POP-UP HOVER
       Everything lifts up on hover
       ═══════════════════════════════════════════ */
    .card,
    .feature-card,
    .highlight-card,
    .poke-card:not(.empty),
    .stat-card,
    .gym-badge,
    .tech-badge,
    .arch-node,
    .dex-cell,
    .poke-type-badge,
    .poke-move,
    .phase-badge,
    .location-item,
    .live-chip,
    .game-frame-live,
    .game-frame-res,
    .hp-bar-container,
    .journey-item,
    .journey-progress-bar,
    .about-highlight,
    .log-entry,
    .log-action,
    .nav-status,
    .section-label,
    .pokedex-stat,
    .dex-modal-stat,
    .hero-overline,
    .hero-metric,
    .social-icon,
    .pokeball-divider,
    .battle-stat-item,
    .arch-legend-item,
    .mind-pipeline-step,
    .footer-brand-name,
    .sessions-table tbody tr {
      transition: all 0.25s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .card:hover,
    .feature-card:hover,
    .highlight-card:hover,
    .poke-card:not(.empty):hover,
    .stat-card:hover,
    .gym-badge:hover,
    .tech-badge:hover,
    .arch-node:hover,
    .dex-cell:hover,
    .poke-type-badge:hover,
    .poke-move:hover,
    .phase-badge:hover,
    .location-item:hover,
    .live-chip:hover,
    .game-frame-live:hover,
    .game-frame-res:hover,
    .hp-bar-container:hover,
    .journey-item:hover,
    .journey-progress-bar:hover,
    .about-highlight:hover,
    .log-entry:hover,
    .log-action:hover,
    .nav-status:hover,
    .section-label:hover,
    .pokedex-stat:hover,
    .dex-modal-stat:hover,
    .hero-overline:hover,
    .hero-metric:hover,
    .social-icon:hover,
    .pokeball-divider:hover,
    .battle-stat-item:hover,
    .arch-legend-item:hover,
    .mind-pipeline-step:hover,
    .footer-brand-name:hover,
    .sessions-table tbody tr:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
    }

    /* ═══════════════════════════════════════════
       RESPONSIVE
       ═══════════════════════════════════════════ */
    @media (max-width: 1024px) {
      .mind-layout { grid-template-columns: 1fr; }
      .game-frame { grid-row: auto; aspect-ratio: 3 / 2; max-height: 400px; }
      .mind-observe-card { grid-column: 1; grid-row: auto; }
      .mind-reason-card { grid-column: 1; grid-row: auto; }
      .mind-bottom-row { grid-column: 1; grid-template-columns: 1fr 1fr; }
      .battle-overlay { grid-column: 1; }
      .features-grid { grid-template-columns: repeat(2, 1fr); }
      .highlights-grid { grid-template-columns: repeat(2, 1fr); }
      .team-grid { grid-template-columns: repeat(2, 1fr); }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .pokedex-grid { grid-template-columns: repeat(auto-fill, minmax(48px, 1fr)); }
      .arch-row { gap: 6px; }
      .arch-node { min-width: 100px; padding: 12px 16px; }
      .log-entry { grid-template-columns: 60px 56px 1fr; }
      .log-phase { display: none; }
    }
    @media (max-width: 768px) {
      section { padding: 64px 0; }
      .hero-metrics { flex-direction: column; }
      .hero-metric { padding: 16px 24px; }
      .nav-links { display: none; }
      .nav-socials { display: none; }
      .features-grid { grid-template-columns: 1fr; }
      .highlights-grid { grid-template-columns: 1fr; }
      .team-grid { grid-template-columns: 1fr 1fr; }
      .stats-grid { grid-template-columns: 1fr 1fr; }
      .pokedex-grid { grid-template-columns: repeat(auto-fill, minmax(44px, 1fr)); }
      .gym-badge { width: 60px; height: 60px; }
      .arch-row { flex-direction: column; gap: 4px; }
      .arch-arrow { transform: rotate(90deg); }
      .footer-inner { padding: 24px 0 20px; }
      .sessions-table th:nth-child(n+5), .sessions-table td:nth-child(n+5) { display: none; }
      .battle-stats-row { gap: 12px; }
    }
    @media (max-width: 480px) {
      .container { padding: 0 16px; }
      .mind-bottom-row { grid-template-columns: 1fr; }
      .team-grid { grid-template-columns: 1fr; }
      .stats-grid { grid-template-columns: 1fr; }
      .pokedex-grid { grid-template-columns: repeat(auto-fill, minmax(40px, 1fr)); }
      .dex-cell .dex-sprite { width: 24px; height: 24px; }
      .log-entry { grid-template-columns: 48px 1fr; }
      .log-action { display: none; }
      .badges-row { gap: 10px; }
      .gym-badge { width: 50px; height: 50px; }
      .sessions-table th:nth-child(n+4), .sessions-table td:nth-child(n+4) { display: none; }
      .pokedex-header-stats { flex-direction: column; gap: 8px; }
    }
  </style>
</head>
<body>

  <!-- Ambient Glow -->
  <div class="ambient-glow ambient-glow-1"></div>
  <div class="ambient-glow ambient-glow-2"></div>
  <div class="ambient-glow ambient-glow-3"></div>
  <div class="ambient-glow ambient-glow-4"></div>

  <!-- Canvas Background -->
  <canvas id="canvas-bg"></canvas>

  <!-- Loader (Pokeball themed) -->
  <!-- Navigation -->
  <nav id="nav">
    <div class="nav-inner">
      <div class="nav-brand">
        <img src="https://static.wixstatic.com/media/e2da02_71f454fe6c9b411a935cc8deed853ca2~mv2.png" alt="PokeLoop">
        <div class="nav-status" id="nav-status" style="margin-left: 8px;">
          <span class="dot"></span>
          <span id="nav-status-text">Connecting...</span>
        </div>
      </div>
      <div class="nav-brand-spacer"></div>
      <ul class="nav-links">
        <li><a href="#hero">Home</a></li>
        <li><a href="#about">About</a></li>
        <li><a href="#mind">AI Mind</a></li>
        <li><a href="#log">Log</a></li>
        <li><a href="#highlights">Milestones</a></li>
        <li><a href="#team">Team</a></li>
        <li><a href="#pokedex">Pokedex</a></li>
        <li><a href="#journey">Journey</a></li>
        <li><a href="#stats">Stats</a></li>
        <li><a href="#architecture">Architecture</a></li>
        <li><a href="#faq">FAQ</a></li>
      </ul>
      <div class="nav-socials">
        <a class="social-pump" href="https://pump.fun/coin/" target="_blank" rel="noopener" title="Pump.fun">
          <img src="https://static.wixstatic.com/media/e2da02_248e6293fa024f6e9dd4130271bb14c3~mv2.png" alt="Pump.fun">
        </a>
        <a class="social-github" href="https://github.com/PokeLoopBot/PokeLoop" target="_blank" rel="noopener" title="GitHub">
          <img src="https://static.wixstatic.com/media/e2da02_54130f69a18e424cb3f9e81f6d12aaab~mv2.png" alt="GitHub">
        </a>
        <a class="social-x" href="https://x.com/PokeLoopBot" target="_blank" rel="noopener" title="X (Twitter)">
          <img src="https://static.wixstatic.com/media/e2da02_7248f73ef41b4355afd7394c08b66bca~mv2.png" alt="X">
        </a>
        <a class="social-medium" href="https://medium.com/@PokeLoopBot" target="_blank" rel="noopener" title="Medium">
          <img src="https://static.wixstatic.com/media/e2da02_25a046e089ca448ab6fd2074fda399db~mv2.png" alt="Medium">
        </a>
      </div>
    </div>
  </nav>

  <div class="ca-btn" onclick="copyCA(this)">
    <span class="ca-btn-label">CA</span>
    <button class="ca-btn-value">
      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
    </button>
  </div>

  <!-- ==================== HERO ==================== -->
  <section id="hero">
    <svg class="hero-pokeball-bg" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="100" cy="100" r="95" fill="#FFFFFF"/>
      <path d="M5,100 A95,95 0 0,1 195,100 Z" fill="#DC2626"/>
      <circle cx="100" cy="100" r="95" stroke="#222" stroke-width="4" fill="none"/>
      <rect x="5" y="96" width="190" height="8" fill="#222"/>
      <circle cx="100" cy="100" r="24" fill="#222"/>
      <circle cx="100" cy="100" r="16" fill="#FFFFFF" stroke="#222" stroke-width="3"/>
    </svg>
    <div class="hero-overline hero-enter hero-enter-1">
      <span class="live-chip" id="hero-live-chip"><span class="dot"></span> LIVE</span>
      Autonomous AI Agent
    </div>
    <h1 class="hero-title hero-enter hero-enter-2">
      <img src="https://static.wixstatic.com/media/e2da02_ce6d6005c06148ec91c63a339c5231de~mv2.png" alt="PokeLoop" style="height: clamp(100px, 16vw, 180px);">
    </h1>
    <p class="hero-subtitle hero-enter hero-enter-3">
      <strong>Claude Opus 4.6</strong> plays <strong>Pokemon FireRed</strong> 24/7
      on a <strong>Mac Mini</strong>. It screenshots mGBA, reasons through every battle
      and menu, and presses the buttons itself &mdash; zero human input, never stops.
    </p>
    <div class="hero-metrics hero-enter hero-enter-4" id="hero-metrics">
      <div class="hero-metric">
        <div class="hero-metric-value skeleton" id="hm-uptime">--</div>
        <div class="hero-metric-label">Uptime</div>
      </div>
      <div class="hero-metric">
        <div class="hero-metric-value skeleton" id="hm-ticks">--</div>
        <div class="hero-metric-label">Decisions</div>
      </div>
      <div class="hero-metric">
        <div class="hero-metric-value skeleton" id="hm-caught">--</div>
        <div class="hero-metric-label">Caught</div>
      </div>
      <div class="hero-metric">
        <div class="hero-metric-value skeleton" id="hm-badges">--</div>
        <div class="hero-metric-label">Badges</div>
      </div>
    </div>
    <div class="hero-scroll hero-enter hero-enter-5">
      Scroll to explore
      <div class="hero-scroll-line"></div>
    </div>
  </section>

  <!-- ==================== ABOUT ==================== -->
  <section id="about">
    <div class="container">
      <div class="reveal">
        <div class="section-label">About the Project</div>
        <h2>What is PokeLoop?</h2>
        <p class="about-intro">
          PokeLoop is <span class="about-highlight">Claude Opus 4.6</span> playing
          <strong>Pokemon FireRed</strong> from start to finish on a <strong>Mac Mini</strong> &mdash;
          completely autonomously. A Python agent running on the Mac Mini captures screenshots
          from mGBA at 480&times;320, sends them to Claude Opus 4.6 via the Anthropic API,
          and executes Claude's decisions as real keyboard inputs through pydirectinput.
          Every button press &mdash; every A, B, Start, D-pad direction &mdash; is Claude's call.
        </p>
      </div>

      <div class="features-grid">
        <div class="card card-fire feature-card reveal reveal-delay-1" style="--feature-color: var(--blue);">
          <div class="feature-icon" style="--feature-color: var(--blue);"><img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/scope-lens.png" alt="Vision"></div>
          <div class="feature-title">Computer Vision</div>
          <div class="feature-desc">The Mac Mini captures mGBA at 480&times;320 twice per second, encodes it as JPEG base64, and sends it to Claude Opus 4.6 via the Anthropic API. Claude reads dialogue, identifies wild Pokemon, and understands the game state from raw pixels.</div>
        </div>
        <div class="card card-fire feature-card reveal reveal-delay-2" style="--feature-color: var(--purple);">
          <div class="feature-icon" style="--feature-color: var(--purple);"><img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/choice-specs.png" alt="Reasoning"></div>
          <div class="feature-title">Strategic Reasoning</div>
          <div class="feature-desc">Claude Opus 4.6 receives the screenshot alongside live RAM data (HP, level, location, team) read by a Lua script inside mGBA. It cross-references type matchups, current goals, and battle state, then reasons through the best move.</div>
        </div>
        <div class="card card-fire feature-card reveal reveal-delay-3" style="--feature-color: var(--green);">
          <div class="feature-icon" style="--feature-color: var(--green);"><img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/up-grade.png" alt="Control"></div>
          <div class="feature-title">Autonomous Control</div>
          <div class="feature-desc">Claude's JSON response is parsed on the Mac Mini and translated into keyboard inputs via pydirectinput. It controls A (z), B (x), Start (enter), Select (backspace), and arrow keys &mdash; the exact same GBA buttons a human would use.</div>
        </div>
        <div class="card card-fire feature-card reveal reveal-delay-4" style="--feature-color: var(--orange);">
          <div class="feature-icon" style="--feature-color: var(--orange);"><img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/town-map.png" alt="Memory"></div>
          <div class="feature-title">Persistent Memory</div>
          <div class="feature-desc">A ChromaDB vector database running on the Mac Mini stores Claude's past observations, battle outcomes, and exploration notes. Before each decision, relevant memories are retrieved and injected into Claude's prompt for context.</div>
        </div>
        <div class="card card-fire feature-card reveal reveal-delay-5" style="--feature-color: var(--red-light);">
          <div class="feature-icon" style="--feature-color: var(--red-light);"><img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/black-belt.png" alt="Battle"></div>
          <div class="feature-title">Battle Intelligence</div>
          <div class="feature-desc">A Python type effectiveness engine feeds Claude the full matchup table for the current battle. Claude sees damage multipliers, remaining HP, available moves, and PP counts &mdash; then picks the highest-value play.</div>
        </div>
        <div class="card card-fire feature-card reveal reveal-delay-6" style="--feature-color: var(--gold);">
          <div class="feature-icon" style="--feature-color: var(--gold);"><img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/old-sea-map.png" alt="Planning"></div>
          <div class="feature-title">Goal Planning</div>
          <div class="feature-desc">A 22-step progression tree hardcoded in Python guides Claude from Professor Oak's lab in Pallet Town through all 8 gym badges to the Elite Four at Indigo Plateau. Goals auto-advance when RAM data confirms completion.</div>
        </div>
      </div>

      <div class="reveal" style="margin-top: 64px; text-align: center;">
        <p style="font-size: 15px; color: var(--text-muted); max-width: 600px; margin: 0 auto; line-height: 1.7;">
          Playing Pokemon is deceptively complex for an AI. It requires reading dialogue,
          navigating tile-based maps, managing menus, making strategic battle decisions,
          and maintaining long-term goals across hours of gameplay &mdash; all from visual
          input alone.
        </p>
      </div>
    </div>
  </section>

  <!-- Pokeball Divider -->
  <div class="pokeball-divider">
    <div class="pokeball-divider-line"></div>
    <svg viewBox="0 0 100 100" fill="none">
      <circle cx="50" cy="50" r="46" fill="#FFFFFF"/>
      <path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/>
      <circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/>
      <rect x="4" y="48" width="92" height="4" fill="#333"/>
      <circle cx="50" cy="50" r="12" fill="#333"/>
      <circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/>
    </svg>
    <div class="pokeball-divider-line"></div>
  </div>

  <!-- Location Strip -->
  <div class="location-strip">
    <div class="container">
      <div class="location-inner">
        <div class="location-item">
          <span class="label">Location</span>
          <span class="value" id="loc-map">--</span>
        </div>
        <span class="location-sep">/</span>
        <div class="location-item">
          <span class="label">Coordinates</span>
          <span class="value" id="loc-coords">--</span>
        </div>
        <span class="location-sep">/</span>
        <div class="location-item">
          <span class="label">Phase</span>
          <span id="loc-phase"><span class="phase-badge overworld">Exploring</span></span>
        </div>
        <span class="location-sep">/</span>
        <div class="location-item">
          <span class="label">Model</span>
          <span class="value">Claude Opus 4.6</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== AI MIND ==================== -->
  <section id="mind">
    <div class="container">
      <div class="reveal">
        <div class="section-label">AI Mind</div>
        <h2>Real-Time Thinking</h2>
        <p class="section-desc">Watch Claude Opus 4.6 think in real-time. Every 500ms the Mac Mini screenshots mGBA, sends it to Claude, and Claude responds with an observation, reasoning, action, and next plan.</p>
      </div>

      <div class="mind-pipeline reveal reveal-delay-1">
        <div class="mind-pipeline-step" style="color: var(--blue)"><span class="step-dot" style="background: var(--blue)"></span> Observe</div>
        <span class="mind-pipeline-arrow">&rarr;</span>
        <div class="mind-pipeline-step" style="color: var(--purple)"><span class="step-dot" style="background: var(--purple)"></span> Reason</div>
        <span class="mind-pipeline-arrow">&rarr;</span>
        <div class="mind-pipeline-step" style="color: var(--green)"><span class="step-dot" style="background: var(--green)"></span> Act</div>
        <span class="mind-pipeline-arrow">&rarr;</span>
        <div class="mind-pipeline-step" style="color: var(--orange)"><span class="step-dot" style="background: var(--orange)"></span> Plan</div>
      </div>

      <div class="mind-layout">
        <!-- Left: Game Screen -->
        <div class="game-frame reveal reveal-delay-2" id="game-frame">
          <div class="game-frame-live"><span class="dot"></span> FEED</div>
          <div class="game-frame-res">480 x 320</div>
          <div class="game-frame-placeholder" id="game-placeholder">
            <svg viewBox="0 0 200 200" width="80" height="80" fill="none">
              <circle cx="100" cy="100" r="90" stroke="white" stroke-width="4"/>
              <rect x="10" y="97" width="180" height="6" fill="white"/>
              <circle cx="100" cy="100" r="24" stroke="white" stroke-width="4" fill="none"/>
              <circle cx="100" cy="100" r="10" fill="white"/>
            </svg>
            <div class="game-frame-placeholder-text">Game feed will appear here</div>
            <div class="game-frame-placeholder-sub">Awaiting screenshot stream connection</div>
          </div>
          <img id="game-screenshot" style="display:none;" alt="Pokemon FireRed gameplay">
        </div>

        <!-- Right top: Observation -->
        <div class="card card-glow mind-card mind-observe-card reveal reveal-delay-3">
          <div class="mind-card-label observe"><span class="indicator"></span> Observation</div>
          <div class="mind-card-text skeleton" id="mind-observe">Waiting for data...</div>
        </div>

        <!-- Right bottom: Reasoning -->
        <div class="card mind-card mind-reason-card reveal reveal-delay-4">
          <div class="mind-card-label reason"><span class="indicator"></span> Reasoning</div>
          <div class="mind-card-text skeleton" id="mind-reason">--</div>
        </div>

        <!-- Full-width bottom: Action + Plan -->
        <div class="mind-bottom-row">
          <div class="card mind-card reveal reveal-delay-5">
            <div class="mind-card-label act"><span class="indicator"></span> Action</div>
            <div id="mind-act">
              <div class="mind-action-display">
                <span class="mind-action-key" id="mind-act-key">--</span>
                <span class="mind-action-detail" id="mind-act-detail"></span>
              </div>
            </div>
          </div>
          <div class="card mind-card reveal reveal-delay-6">
            <div class="mind-card-label plan"><span class="indicator"></span> Next Plan</div>
            <div class="mind-card-text skeleton" id="mind-plan">--</div>
          </div>
        </div>

        <!-- Battle Overlay (visible only during battle phase) -->
        <div class="card battle-overlay" id="battle-overlay">
          <div class="battle-banner">
            <div class="battle-banner-title"><span class="dot"></span> BATTLE IN PROGRESS</div>
            <div class="battle-banner-type" id="battle-type">Wild Battle</div>
          </div>
          <div class="battle-stats-row">
            <div class="battle-stat-item">Turns: <span class="val" id="battle-turns">0</span></div>
            <div class="battle-stat-item">Won: <span class="val" id="battle-won">0</span></div>
            <div class="battle-stat-item">Fled: <span class="val" id="battle-fled">0</span></div>
            <div class="battle-stat-item">Whiteouts: <span class="val" id="battle-whiteouts">0</span></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="pokeball-divider">
    <div class="pokeball-divider-line"></div>
    <svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="46" fill="#FFFFFF"/><path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/><circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/><rect x="4" y="48" width="92" height="4" fill="#333"/><circle cx="50" cy="50" r="12" fill="#333"/><circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/></svg>
    <div class="pokeball-divider-line"></div>
  </div>

  <!-- ==================== ACTION LOG ==================== -->
  <section id="log">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Action Log</div>
        <h2>Decision Stream</h2>
        <p class="section-desc">The last 20 actions Claude took. Each entry is one decision cycle &mdash; Claude saw the screen, reasoned about it, and pressed a button.</p>
      </div>
      <div class="card reveal reveal-delay-1" style="padding: 8px 0; overflow: hidden;">
        <div class="log-list" id="log-list">
          <div style="text-align:center;padding:32px;color:var(--text-dim);font-size:13px;">Loading action log...</div>
        </div>
      </div>
    </div>
  </section>

  <div class="pokeball-divider">
    <div class="pokeball-divider-line"></div>
    <svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="46" fill="#FFFFFF"/><path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/><circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/><rect x="4" y="48" width="92" height="4" fill="#333"/><circle cx="50" cy="50" r="12" fill="#333"/><circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/></svg>
    <div class="pokeball-divider-line"></div>
  </div>

  <!-- ==================== HIGHLIGHTS ==================== -->
  <section id="highlights">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Milestones</div>
        <h2>Key Achievements</h2>
        <p class="section-desc">Achievements unlocked as Claude progresses through Pokemon FireRed. Tracked via RAM reads on the Mac Mini &mdash; locked milestones show what's coming next.</p>
      </div>
      <div class="highlights-grid" id="highlights-grid"></div>
    </div>
  </section>

  <div class="pokeball-divider">
    <div class="pokeball-divider-line"></div>
    <svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="46" fill="#FFFFFF"/><path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/><circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/><rect x="4" y="48" width="92" height="4" fill="#333"/><circle cx="50" cy="50" r="12" fill="#333"/><circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/></svg>
    <div class="pokeball-divider-line"></div>
  </div>

  <!-- ==================== TEAM ==================== -->
  <section id="team">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Team</div>
        <h2>Current Party</h2>
        <p class="section-desc">Claude's active Pokemon team, read directly from FireRed's RAM in real-time via a Lua script running inside mGBA on the Mac Mini. Species, level, HP, moves &mdash; all pulled from memory addresses.</p>
      </div>
      <div class="team-grid" id="team-grid"></div>
      <div class="badges-section reveal reveal-delay-2">
        <div style="text-align: center;">
          <div class="section-label" style="justify-content: center;">Kanto Gym Badges</div>
          <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">Defeat all 8 gym leaders to reach the Elite Four</p>
        </div>
        <div class="badges-row" id="badges-row"></div>
      </div>
    </div>
  </section>

  <div class="pokeball-divider">
    <div class="pokeball-divider-line"></div>
    <svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="46" fill="#FFFFFF"/><path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/><circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/><rect x="4" y="48" width="92" height="4" fill="#333"/><circle cx="50" cy="50" r="12" fill="#333"/><circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/></svg>
    <div class="pokeball-divider-line"></div>
  </div>

  <!-- ==================== POKEDEX ==================== -->
  <section id="pokedex">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Pokedex</div>
        <h2>Kanto Pokemon</h2>
        <p class="section-desc">The original 151 Kanto Pokemon. Pokemon Claude has caught or seen are highlighted with their type colors. Click any entry for full PokeAPI data.</p>
      </div>
      <div class="pokedex-header-stats reveal reveal-delay-1">
        <div class="pokedex-stat">In Party: <span class="val" id="dex-party-count">0</span> / 6</div>
        <div class="pokedex-stat">Species Seen: <span class="val" id="dex-seen-count">0</span> / 151</div>
      </div>
      <div class="pokedex-grid reveal reveal-delay-2" id="pokedex-grid"></div>
    </div>
  </section>

  <!-- Pokedex Detail Modal -->
  <div class="dex-modal-overlay" id="dex-modal-overlay">
    <div class="dex-modal">
      <div class="dex-modal-header">
        <img class="dex-modal-sprite" id="dex-modal-sprite" src="" alt="">
        <div class="dex-modal-info">
          <div class="dex-modal-number" id="dex-modal-number"></div>
          <h3 class="dex-modal-name" id="dex-modal-name"></h3>
          <div class="dex-modal-types" id="dex-modal-types"></div>
        </div>
        <button class="dex-modal-close" id="dex-modal-close">&times;</button>
      </div>
      <div class="dex-modal-body">
        <p class="dex-modal-flavor" id="dex-modal-flavor">Loading...</p>
        <div class="dex-modal-stats" id="dex-modal-stats"></div>
      </div>
    </div>
  </div>

  <div class="pokeball-divider">
    <div class="pokeball-divider-line"></div>
    <svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="46" fill="#FFFFFF"/><path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/><circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/><rect x="4" y="48" width="92" height="4" fill="#333"/><circle cx="50" cy="50" r="12" fill="#333"/><circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/></svg>
    <div class="pokeball-divider-line"></div>
  </div>

  <!-- ==================== JOURNEY ==================== -->
  <section id="journey">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Journey</div>
        <h2>FireRed Progression</h2>
        <p class="section-desc">Claude follows a 22-step progression tree through FireRed &mdash; from picking a starter in Pallet Town to challenging the Elite Four. Progress auto-updates when RAM confirms each milestone.</p>
      </div>
      <div class="reveal reveal-delay-1" style="margin-top: 40px;">
        <div class="journey-header">
          <span style="font-size: 13px; color: var(--text-muted);">Overall Progress</span>
          <span class="journey-progress-text" id="journey-pct">0%</span>
        </div>
        <div class="journey-progress-bar">
          <div class="journey-progress-fill" id="journey-fill" style="width: 0%;"></div>
        </div>
      </div>
      <div class="journey-timeline reveal reveal-delay-2" id="journey-timeline"></div>
    </div>
  </section>

  <div class="pokeball-divider">
    <div class="pokeball-divider-line"></div>
    <svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="46" fill="#FFFFFF"/><path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/><circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/><rect x="4" y="48" width="92" height="4" fill="#333"/><circle cx="50" cy="50" r="12" fill="#333"/><circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/></svg>
    <div class="pokeball-divider-line"></div>
  </div>

  <!-- ==================== STATS ==================== -->
  <section id="stats">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Trainer Stats</div>
        <h2>Performance Metrics</h2>
        <p class="section-desc">Every battle, step, and catch Claude makes is tracked. Stats are read directly from FireRed's RAM by the Lua script and fed to the live dashboard running on the Mac Mini.</p>
      </div>
      <div class="stats-grid" id="stats-grid"></div>

      <div class="reveal" style="margin-top: 64px;">
        <h3 style="margin-bottom: 8px;">Session History</h3>
        <p style="font-size: 14px; color: var(--text-muted); margin-bottom: 16px;">Each session represents a continuous run of the AI agent from startup to shutdown.</p>
        <div class="card" style="padding: 0; overflow: hidden;">
          <table class="sessions-table">
            <thead><tr>
              <th>Session</th><th>Duration</th><th>Ticks</th><th>Badges</th><th>Caught</th><th>Whiteouts</th>
            </tr></thead>
            <tbody id="sessions-body">
              <tr><td colspan="6" style="text-align: center; color: var(--text-dim); padding: 24px;">Loading sessions...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <div class="pokeball-divider">
    <div class="pokeball-divider-line"></div>
    <svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="46" fill="#FFFFFF"/><path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/><circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/><rect x="4" y="48" width="92" height="4" fill="#333"/><circle cx="50" cy="50" r="12" fill="#333"/><circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/></svg>
    <div class="pokeball-divider-line"></div>
  </div>

  <!-- ==================== ARCHITECTURE ==================== -->
  <section id="architecture">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Architecture</div>
        <h2>System Design</h2>
        <p class="section-desc">The full pipeline running 24/7 on a single Mac Mini: mGBA emulator &rarr; Lua RAM reader &rarr; Python agent &rarr; Claude Opus 4.6 via Anthropic API &rarr; pydirectinput keyboard control.</p>
      </div>
      <div class="arch-flow reveal reveal-delay-1">
        <div class="arch-row">
          <div class="arch-node infra"><div class="arch-node-label">Mac Mini</div><div class="arch-node-desc">Runs 24/7 &mdash; hosts everything</div></div>
          <span class="arch-arrow">&rarr;</span>
          <div class="arch-node data"><div class="arch-node-label">mGBA Emulator</div><div class="arch-node-desc">Pokemon FireRed ROM</div></div>
          <span class="arch-arrow">&rarr;</span>
          <div class="arch-node data"><div class="arch-node-label">Lua Script</div><div class="arch-node-desc">Reads RAM every 30 frames</div></div>
          <span class="arch-arrow">&rarr;</span>
          <div class="arch-node data"><div class="arch-node-label">Game State JSON</div><div class="arch-node-desc">Party, map, badges, HP</div></div>
        </div>
        <div class="arch-arrow-down">&darr;</div>
        <div class="arch-row">
          <div class="arch-node output"><div class="arch-node-label">Keyboard Input</div><div class="arch-node-desc">pydirectinput to mGBA</div></div>
          <span class="arch-arrow">&larr;</span>
          <div class="arch-node ai"><div class="arch-node-label">Decision Engine</div><div class="arch-node-desc">Goals + battle + memory</div></div>
          <span class="arch-arrow">&larr;</span>
          <div class="arch-node ai"><div class="arch-node-label">Claude Opus 4.6</div><div class="arch-node-desc">Vision LLM via Anthropic API</div></div>
          <span class="arch-arrow">&larr;</span>
          <div class="arch-node ai"><div class="arch-node-label">Screenshot</div><div class="arch-node-desc">480&times;320 JPEG capture</div></div>
        </div>
        <div class="arch-arrow-down">&darr;</div>
        <div class="arch-row">
          <div class="arch-node infra"><div class="arch-node-label">ChromaDB</div><div class="arch-node-desc">Vector memory on Mac Mini</div></div>
          <span class="arch-arrow">&rarr;</span>
          <div class="arch-node ai"><div class="arch-node-label">Python Agent</div><div class="arch-node-desc">Core orchestrator on Mac Mini</div></div>
          <span class="arch-arrow">&rarr;</span>
          <div class="arch-node output"><div class="arch-node-label">Live Dashboard</div><div class="arch-node-desc">Real-time feed</div></div>
        </div>
      </div>
      <div class="arch-legend reveal reveal-delay-2">
        <div class="arch-legend-item"><span class="arch-legend-dot" style="background: var(--blue);"></span> Data Pipeline</div>
        <div class="arch-legend-item"><span class="arch-legend-dot" style="background: var(--red-light);"></span> AI / Reasoning</div>
        <div class="arch-legend-item"><span class="arch-legend-dot" style="background: var(--green);"></span> Output</div>
        <div class="arch-legend-item"><span class="arch-legend-dot" style="background: var(--orange);"></span> Infrastructure</div>
      </div>

      <div class="reveal" style="margin-top: 56px; text-align: center;">
        <h3 style="margin-bottom: 16px;">Tech Stack</h3>
        <div class="tech-grid">
          <span class="tech-badge">Mac Mini</span>
          <span class="tech-badge">Python 3.11</span>
          <span class="tech-badge">Claude Opus 4.6</span>
          <span class="tech-badge">Anthropic API</span>
          <span class="tech-badge">mGBA Emulator</span>
          <span class="tech-badge">Lua 5.4</span>
          <span class="tech-badge">ChromaDB</span>
          <span class="tech-badge">pydirectinput</span>
          <span class="tech-badge">mss (screenshots)</span>
        </div>
      </div>
    </div>
  </section>

  <!-- ==================== FAQ ==================== -->
  <section id="faq">
    <div class="container">
      <div class="reveal">
        <div class="section-label">Frequently Asked Questions</div>
        <h2>FAQ</h2>
        <p class="section-desc">Everything you need to know about PokeLoop.</p>
      </div>
      <div class="faq-grid reveal">
        <div class="faq-item" onclick="toggleFaq(this)">
          <div class="faq-question">
            <span class="faq-q-text">What is PokeLoop and how does it work?</span>
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">
            <div class="faq-a-text">PokeLoop is a fully autonomous AI agent that plays Pokemon FireRed end-to-end on a dedicated Mac Mini. The system operates on a <code>500ms decision cycle</code>: it captures the mGBA emulator frame, encodes it as a base64 JPEG, pairs it with structured game state extracted from RAM via a custom Lua script, and sends both to <code>Claude Opus 4.6</code> through the Anthropic API. The model returns a JSON-structured decision — action, reasoning, and confidence — which the input handler executes via DirectInput scan codes. No human touches the keyboard. Ever.</div>
          </div>
        </div>
        <div class="faq-item" onclick="toggleFaq(this)">
          <div class="faq-question">
            <span class="faq-q-text">How does the vision pipeline process each frame?</span>
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">
            <div class="faq-a-text">The screen capture module uses <code>mss</code> to grab the mGBA window at <code>480x320</code> resolution, compresses it to JPEG at quality 40 (keeping file size under 50KB), and base64-encodes it. This frame is merged with a structured context payload containing party HP/PP, opponent species and types, current map ID, badge count, inventory, and the active goal from the 22-step progression tree. The combined payload hits the Anthropic multimodal endpoint, and the model reasons over both visual and structured data simultaneously.</div>
          </div>
        </div>
        <div class="faq-item" onclick="toggleFaq(this)">
          <div class="faq-question">
            <span class="faq-q-text">What does the Lua RAM reader actually extract?</span>
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">
            <div class="faq-a-text">The Lua script runs inside mGBA and reads FireRed v1.0 US memory addresses every 30 frames. It decrypts the Gen III Pokemon data structure — handling PID-based substructure reordering (<code>PID % 24</code> determines the permutation of Growth, Attacks, EVs, and Misc blocks) and XOR decryption using the personality value. It extracts party data, opponent data, battle state flags, map coordinates, trainer name, badge bitmask, and Pokedex counts, then writes everything to <code>game_state.json</code> using an inline JSON encoder (mGBA has no JSON library).</div>
          </div>
        </div>
        <div class="faq-item" onclick="toggleFaq(this)">
          <div class="faq-question">
            <span class="faq-q-text">How does the battle engine make combat decisions?</span>
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">
            <div class="faq-a-text">The battle manager cross-references the opponent's species against a full <code>18x18 type effectiveness matrix</code> and injects matchup data directly into the prompt. It tracks cursor position in the 2x2 move grid, calculates STAB bonuses, evaluates remaining PP across all four move slots, and monitors HP thresholds. When HP drops below 30%, an interrupt-driven healing system overrides the attack sequence — navigating the bag menu, selecting the right Potion, and executing a multi-tick input sequence. The system also maintains a list of nearby Pokemon Centers for strategic retreats.</div>
          </div>
        </div>
        <div class="faq-item" onclick="toggleFaq(this)">
          <div class="faq-question">
            <span class="faq-q-text">What infrastructure runs this 24/7?</span>
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">
            <div class="faq-a-text">A single Mac Mini. That's it. The mGBA emulator, Python agent process, Lua RAM reader, and screenshot pipeline all run locally. The only external dependency is the Anthropic API for Claude's inference. Game state is persisted to <code>ChromaDB</code> for semantic vector memory (the AI can recall past experiences by similarity search) and to <code>PostgreSQL</code> on Railway for the live dashboard feed. No Kubernetes, no Docker, no load balancers — one machine, one process, running indefinitely.</div>
          </div>
        </div>
        <div class="faq-item" onclick="toggleFaq(this)">
          <div class="faq-question">
            <span class="faq-q-text">What's the goal progression system?</span>
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">
            <div class="faq-a-text">A hardcoded 22-step DAG (directed acyclic graph) defines the optimal route from Professor Oak's lab to the Pokemon League Champion. Each node has completion conditions validated against RAM state — badge bitmask checks, Pokedex flags, map ID comparisons, and party size thresholds. When conditions are met, the planner auto-advances to the next goal and injects updated navigation context into the prompt. The system handles stuck detection with a configurable tick threshold: if no meaningful state change occurs within N ticks, it triggers an exploration override.</div>
          </div>
        </div>
        <div class="faq-item" onclick="toggleFaq(this)">
          <div class="faq-question">
            <span class="faq-q-text">Is the dashboard showing real-time data?</span>
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">
            <div class="faq-a-text">Yes. The dashboard polls the Railway API endpoint every <code>5 seconds</code>. Every stat, log entry, party member, and badge you see reflects the actual game state from the Mac Mini. The green "Online" indicator confirms the agent is actively running. When the system goes offline, the dashboard freezes on the last known state and switches to a red "Offline" indicator. Historical decision logs, catch events, and battle outcomes are all persisted and queryable.</div>
          </div>
        </div>
        <div class="faq-item" onclick="toggleFaq(this)">
          <div class="faq-question">
            <span class="faq-q-text">Where's the source code?</span>
            <span class="faq-toggle">+</span>
          </div>
          <div class="faq-answer">
            <div class="faq-a-text">The full codebase — agent core, Lua RAM reader, battle manager, goal planner, ChromaDB memory, and dashboard — is open source on <a href="https://github.com/PokeLoopBot/PokeLoop" target="_blank">GitHub</a> under the MIT license. 26 files, ~5,000 lines of code. The <code>memory_reader.py</code> alone is 999 lines containing all 386 species names and 354 move names for Gen III.</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ==================== FOOTER ==================== -->
  <footer>
    <div class="footer-divider">
      <div class="pokeball-divider">
        <div class="pokeball-divider-line"></div>
        <svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="46" fill="#FFFFFF"/><path d="M4,50 A46,46 0 0,1 96,50 Z" fill="#DC2626"/><circle cx="50" cy="50" r="46" stroke="#333" stroke-width="3" fill="none"/><rect x="4" y="48" width="92" height="4" fill="#333"/><circle cx="50" cy="50" r="12" fill="#333"/><circle cx="50" cy="50" r="8" fill="#FFFFFF" stroke="#333" stroke-width="2"/></svg>
        <div class="pokeball-divider-line"></div>
      </div>
    </div>
    <div class="container">
      <div class="footer-inner">
        <div class="footer-brand-name">
          <img src="https://static.wixstatic.com/media/e2da02_ce6d6005c06148ec91c63a339c5231de~mv2.png" alt="PokeLoop" style="height: 60px;">
        </div>
        <div class="footer-tagline">Claude Opus 4.6 playing Pokemon FireRed 24/7 on a Mac Mini.</div>
        <div class="footer-bottom">
          <span>&copy; 2026 PokeLoop</span>
        </div>
      </div>
    </div>
  </footer>

  <!-- ==================== JAVASCRIPT ==================== -->
  <script>
    /* ═══════════════════════════════════════════
       CA COPY
       ═══════════════════════════════════════════ */
    function copyCA(el) {
      navigator.clipboard.writeText('XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX').then(() => {
        el.classList.add('copied');
        const val = el.querySelector('.ca-btn-value');
        const orig = val.innerHTML;
        val.innerHTML = 'Copied! <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>';
        setTimeout(() => { val.innerHTML = orig; el.classList.remove('copied'); }, 1500);
      });
    }

    function toggleFaq(item) {
      const wasOpen = item.classList.contains('open');
      document.querySelectorAll('.faq-item.open').forEach(i => i.classList.remove('open'));
      if (!wasOpen) item.classList.add('open');
    }

    /* ═══════════════════════════════════════════
       CONFIG
       ═══════════════════════════════════════════ */
    const API = 'https://runescape-production-41f8.up.railway.app';
    const POLL_MS = 5000;
    const SPRITE_URL = 'https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon';
    const ITEM_SPRITE = 'https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items';

    const BADGE_DATA = [
      { name: 'Boulder', icon: 'https://static.wixstatic.com/media/e2da02_55624c18ead5459ba99935528d3ecf4b~mv2.png', type: 'Rock',     color: '#B8A038' },
      { name: 'Cascade', icon: 'https://static.wixstatic.com/media/e2da02_722ab9abea7047268c1301388ee09e2a~mv2.png', type: 'Water',    color: '#6890F0' },
      { name: 'Thunder', icon: 'https://static.wixstatic.com/media/e2da02_c824ca437e3c488f97da5cadb23a1287~mv2.png', type: 'Electric', color: '#F8D030' },
      { name: 'Rainbow', icon: 'https://static.wixstatic.com/media/e2da02_04dce971f82f46588719a00a7bab564d~mv2.png', type: 'Grass',    color: '#78C850' },
      { name: 'Marsh',   icon: 'https://static.wixstatic.com/media/e2da02_91a7a616e8d0404eb84cec19a4d659d9~mv2.png', type: 'Psychic',  color: '#F85888' },
      { name: 'Soul',    icon: 'https://static.wixstatic.com/media/e2da02_aed4cb3041554f0bbf34189b7b699067~mv2.png', type: 'Poison',   color: '#A040A0' },
      { name: 'Volcano', icon: 'https://static.wixstatic.com/media/e2da02_45182101bb9a4b2ea832e7a1928bcb34~mv2.png', type: 'Fire',     color: '#F08030' },
      { name: 'Earth',   icon: 'https://static.wixstatic.com/media/e2da02_c9925bb760fa4dd19feef070a29c546c~mv2.png', type: 'Ground',   color: '#E0C068' }
    ];

    const STAT_DEFS = [
      { key: 'pokemon_caught',  label: 'Caught',       color: '#6890F0', format: 'int' },
      { key: 'battles_won',     label: 'Battles Won',  color: '#78C850', format: 'int' },
      { key: 'whiteouts',       label: 'Whiteouts',    color: '#F08030', format: 'int' },
      { key: 'steps_taken',     label: 'Steps Taken',  color: '#A890F0', format: 'int' },
      { key: 'money',           label: 'Money',        color: '#F8D030', format: 'money' },
      { key: 'pokedex_pct',     label: 'Pokedex',      color: '#F85888', format: 'pct' },
      { key: 'highest_level',   label: 'Highest Lv',   color: '#F08030', format: 'int' },
      { key: 'total_ticks',     label: 'Total Ticks',  color: '#98D8D8', format: 'int' }
    ];

    const PHASE_MAP = {
      overworld:  { label: 'Exploring',    cls: 'overworld' },
      battle:     { label: 'In Battle',    cls: 'battle' },
      dialogue:   { label: 'Dialogue',     cls: 'dialogue' },
      menu:       { label: 'Menu',         cls: 'menu' },
      title:      { label: 'Title Screen', cls: 'title' },
      transition: { label: 'Loading',      cls: 'transition' }
    };

    /* Pokemon type lookup by species ID (Gen 1-3 primary types) */
    const SPECIES_TYPE = {
      1:'grass',2:'grass',3:'grass',4:'fire',5:'fire',6:'fire',7:'water',8:'water',9:'water',
      10:'bug',11:'bug',12:'bug',13:'bug',14:'bug',15:'bug',16:'normal',17:'normal',18:'normal',
      19:'normal',20:'normal',21:'normal',22:'normal',23:'poison',24:'poison',25:'electric',
      26:'electric',27:'ground',28:'ground',29:'poison',30:'poison',31:'poison',32:'poison',
      33:'poison',34:'poison',35:'fairy',36:'fairy',37:'fire',38:'fire',39:'normal',40:'normal',
      41:'poison',42:'poison',43:'grass',44:'grass',45:'grass',46:'bug',47:'bug',48:'bug',49:'bug',
      50:'ground',51:'ground',52:'normal',53:'normal',54:'water',55:'water',56:'fighting',57:'fighting',
      58:'fire',59:'fire',60:'water',61:'water',62:'water',63:'psychic',64:'psychic',65:'psychic',
      66:'fighting',67:'fighting',68:'fighting',69:'grass',70:'grass',71:'grass',72:'water',73:'water',
      74:'rock',75:'rock',76:'rock',77:'fire',78:'fire',79:'water',80:'water',81:'electric',82:'electric',
      83:'normal',84:'normal',85:'normal',86:'water',87:'water',88:'poison',89:'poison',90:'water',
      91:'water',92:'ghost',93:'ghost',94:'ghost',95:'rock',96:'psychic',97:'psychic',98:'water',99:'water',
      100:'electric',101:'electric',102:'grass',103:'grass',104:'ground',105:'ground',106:'fighting',
      107:'fighting',108:'normal',109:'poison',110:'poison',111:'ground',112:'ground',113:'normal',
      114:'grass',115:'normal',116:'water',117:'water',118:'water',119:'water',120:'water',121:'water',
      122:'psychic',123:'bug',124:'ice',125:'electric',126:'fire',127:'bug',128:'normal',129:'water',
      130:'water',131:'water',132:'normal',133:'normal',134:'water',135:'electric',136:'fire',
      137:'normal',138:'rock',139:'rock',140:'rock',141:'rock',142:'rock',143:'normal',144:'ice',
      145:'electric',146:'fire',147:'dragon',148:'dragon',149:'dragon',150:'psychic',151:'psychic',
      152:'grass',153:'grass',154:'grass',155:'fire',156:'fire',157:'fire',158:'water',159:'water',
      160:'water',161:'normal',162:'normal',163:'normal',164:'normal',165:'bug',166:'bug',
      167:'bug',168:'bug',169:'poison',170:'water',171:'water',172:'electric',173:'fairy',174:'normal',
      175:'fairy',176:'fairy',177:'psychic',178:'psychic',179:'electric',180:'electric',181:'electric',
      182:'grass',183:'water',184:'water',185:'rock',186:'water',187:'grass',188:'grass',189:'grass',
      190:'normal',191:'grass',192:'grass',193:'bug',194:'water',195:'water',196:'psychic',197:'dark',
      198:'dark',199:'water',200:'ghost',201:'psychic',202:'psychic',203:'normal',204:'bug',205:'bug',
      206:'normal',207:'ground',208:'steel',209:'fairy',210:'fairy',211:'water',212:'bug',213:'bug',
      214:'bug',215:'dark',216:'normal',217:'normal',218:'fire',219:'fire',220:'ice',221:'ice',
      222:'water',223:'water',224:'water',225:'ice',226:'water',227:'steel',228:'dark',229:'dark',
      230:'water',231:'ground',232:'ground',233:'normal',234:'normal',235:'normal',236:'fighting',
      237:'fighting',238:'ice',239:'electric',240:'fire',241:'normal',242:'normal',243:'electric',
      244:'fire',245:'water',246:'rock',247:'rock',248:'rock',249:'psychic',250:'fire',251:'psychic',
      252:'grass',253:'grass',254:'grass',255:'fire',256:'fire',257:'fire',258:'water',259:'water',
      260:'water',261:'dark',262:'dark',263:'normal',264:'normal',265:'bug',266:'bug',267:'bug',
      268:'bug',269:'bug',270:'water',271:'water',272:'water',273:'grass',274:'grass',275:'grass',
      276:'normal',277:'normal',278:'water',279:'water',280:'psychic',281:'psychic',282:'psychic',
      283:'bug',284:'bug',285:'grass',286:'grass',287:'normal',288:'normal',289:'normal',290:'bug',
      291:'bug',292:'bug',293:'normal',294:'normal',295:'normal',296:'fighting',297:'fighting',
      298:'normal',299:'rock',300:'normal',301:'normal',302:'dark',303:'steel',304:'steel',305:'steel',
      306:'steel',307:'fighting',308:'fighting',309:'electric',310:'electric',311:'electric',312:'electric',
      313:'bug',314:'bug',315:'grass',316:'poison',317:'poison',318:'water',319:'water',320:'water',
      321:'water',322:'fire',323:'fire',324:'fire',325:'psychic',326:'psychic',327:'normal',
      328:'ground',329:'ground',330:'ground',331:'grass',332:'grass',333:'normal',334:'dragon',
      335:'normal',336:'poison',337:'rock',338:'rock',339:'water',340:'water',341:'water',342:'water',
      343:'ground',344:'ground',345:'rock',346:'rock',347:'rock',348:'rock',349:'water',350:'water',
      351:'normal',352:'normal',353:'ghost',354:'ghost',355:'ghost',356:'ghost',357:'grass',358:'psychic',
      359:'dark',360:'psychic',361:'ice',362:'ice',363:'ice',364:'ice',365:'ice',366:'water',367:'water',
      368:'water',369:'water',370:'water',371:'dragon',372:'dragon',373:'dragon',374:'steel',375:'steel',
      376:'steel',377:'rock',378:'ice',379:'steel',380:'dragon',381:'dragon',382:'water',383:'ground',
      384:'dragon',385:'steel',386:'psychic'
    };

    const TYPE_COLORS = {
      normal:'#A8A878',fire:'#F08030',water:'#6890F0',grass:'#78C850',electric:'#F8D030',
      ice:'#98D8D8',fighting:'#C03028',poison:'#A040A0',ground:'#E0C068',flying:'#A890F0',
      psychic:'#F85888',bug:'#A8B820',rock:'#B8A038',ghost:'#705898',dragon:'#7038F8',
      dark:'#705848',steel:'#B8B8D0',fairy:'#EE99AC'
    };

    /* Gen 1 Pokemon names (151) */
    const GEN1_NAMES = [
      'bulbasaur','ivysaur','venusaur','charmander','charmeleon','charizard',
      'squirtle','wartortle','blastoise','caterpie','metapod','butterfree',
      'weedle','kakuna','beedrill','pidgey','pidgeotto','pidgeot',
      'rattata','raticate','spearow','fearow','ekans','arbok',
      'pikachu','raichu','sandshrew','sandslash','nidoran-f','nidorina',
      'nidoqueen','nidoran-m','nidorino','nidoking','clefairy','clefable',
      'vulpix','ninetales','jigglypuff','wigglytuff','zubat','golbat',
      'oddish','gloom','vileplume','paras','parasect','venonat','venomoth',
      'diglett','dugtrio','meowth','persian','psyduck','golduck',
      'mankey','primeape','growlithe','arcanine','poliwag','poliwhirl',
      'poliwrath','abra','kadabra','alakazam','machop','machoke','machamp',
      'bellsprout','weepinbell','victreebel','tentacool','tentacruel',
      'geodude','graveler','golem','ponyta','rapidash','slowpoke','slowbro',
      'magnemite','magneton','farfetchd','doduo','dodrio','seel','dewgong',
      'grimer','muk','shellder','cloyster','gastly','haunter','gengar','onix',
      'drowzee','hypno','krabby','kingler','voltorb','electrode',
      'exeggcute','exeggutor','cubone','marowak','hitmonlee','hitmonchan',
      'lickitung','koffing','weezing','rhyhorn','rhydon','chansey','tangela',
      'kangaskhan','horsea','seadra','goldeen','seaking','staryu','starmie',
      'mr. mime','scyther','jynx','electabuzz','magmar','pinsir','tauros',
      'magikarp','gyarados','lapras','ditto','eevee','vaporeon','jolteon',
      'flareon','porygon','omanyte','omastar','kabuto','kabutops',
      'aerodactyl','snorlax','articuno','zapdos','moltres','dratini',
      'dragonair','dragonite','mewtwo','mew'
    ];

    /* Highlight / Milestone definitions */
    const HIGHLIGHT_DEFS = [
      { id:'first_decision', title:'First Decision',     desc:'The AI made its very first decision',               icon:'old-amber',     color:'#78C850', check: d => (d.tick||0) >= 1 },
      { id:'century',        title:'Thinking Machine',    desc:'Made 100 AI decisions',                             icon:'metronome',     color:'#F85888', check: d => (d.tick||0) >= 100 },
      { id:'thousand_ticks', title:'Thousand Minds',      desc:'Reached 1,000 decision cycles',                     icon:'twisted-spoon', color:'#7038F8', check: d => (d.tick||0) >= 1000 },
      { id:'first_catch',    title:'Gotta Start Somewhere', desc:'Caught the first Pokemon',                        icon:'poke-ball',     color:'#6890F0', check: d => (d.player_stats?.pokemon_caught||0) >= 1 },
      { id:'five_caught',    title:'Collector',            desc:'Caught 5 different Pokemon',                        icon:'luxury-ball',   color:'#A890F0', check: d => (d.player_stats?.pokemon_caught||0) >= 5 },
      { id:'full_team',      title:'Full Squad',           desc:'Assembled a full team of 6 Pokemon',                icon:'exp-share',     color:'#F08030', check: d => (d.game_state?.party||[]).filter(p=>p&&p.species_id).length >= 6 },
      { id:'first_badge',    title:'Badge Collector',      desc:'Earned the first gym badge',                        icon:'kings-rock',    color:'#B8A038', check: d => (d.game_state?.badge_count||0) >= 1 },
      { id:'four_badges',    title:'Halfway There',        desc:'Earned 4 gym badges',                               icon:'dragon-scale',  color:'#F8D030', check: d => (d.game_state?.badge_count||0) >= 4 },
      { id:'ten_wins',       title:'Battle Veteran',       desc:'Won 10 Pokemon battles',                            icon:'sharp-beak',    color:'#C03028', check: d => (d.player_stats?.battles_won||d.battle_stats?.battles_won||0) >= 10 },
      { id:'fifty_wins',     title:'Battle Master',        desc:'Won 50 Pokemon battles',                            icon:'master-ball',   color:'#DC2626', check: d => (d.player_stats?.battles_won||d.battle_stats?.battles_won||0) >= 50 },
      { id:'thousand_steps', title:'Road Warrior',         desc:'Walked 1,000 steps across Kanto',                   icon:'quick-claw',    color:'#A890F0', check: d => (d.player_stats?.steps_taken||0) >= 1000 },
      { id:'level_20',       title:'Power Up',             desc:'Raised a Pokemon to level 20',                      icon:'rare-candy',    color:'#F8D030', check: d => (d.player_stats?.highest_level||0) >= 20 },
      { id:'level_40',       title:'Powerhouse',           desc:'Raised a Pokemon to level 40',                      icon:'protein',       color:'#F97316', check: d => (d.player_stats?.highest_level||0) >= 40 },
      { id:'rich',           title:'Money Maker',          desc:'Accumulated $10,000 in-game',                       icon:'amulet-coin',   color:'#F59E0B', check: d => (d.game_state?.money||0) >= 10000 },
    ];

    /* ═══════════════════════════════════════════
       STATE
       ═══════════════════════════════════════════ */
    let data = null, prev = null, online = false, sessionsData = null;
    let pokedexBuilt = false;
    let usingDemo = false;

    /* ═══════════════════════════════════════════
       DEMO DATA (shown when agent is offline)
       ═══════════════════════════════════════════ */
    const DEMO_DATA = {
      tick: 847,
      timestamp: new Date().toISOString(),
      latency_ms: 312,
      model: 'claude-opus-4-6',
      game_phase: 'overworld',
      observation: 'Standing in Viridian City near the Pokemon Center. The entrance is to the north. A few NPCs are walking around the area.',
      reasoning: 'My lead Pokemon is low on HP after the battles on Route 1. I should heal at the Pokemon Center before continuing north toward Viridian Forest.',
      action: 'UP',
      action_detail: 'Walking toward the Pokemon Center entrance',
      next_plan: 'Heal party at Pokemon Center, then head north through Viridian Forest to reach Pewter City for the first gym battle.',
      uptime: '1h 24m 12s',
      errors: 0,
      total_memories: 63,
      game_state: {
        map_name: 'Viridian City',
        map_id: 1,
        player_x: 23,
        player_y: 18,
        badge_count: 0,
        badges: 0,
        money: 3200,
        pokedex_caught: 3,
        pokedex_seen: 8,
        in_battle: false,
        party: [
          { species_id: 4, species_name: 'Charmander', level: 12, hp_current: 18, hp_max: 35, moves: ['Scratch', 'Ember', 'Leer', 'Smokescreen'] },
          { species_id: 16, species_name: 'Pidgey', level: 8, hp_current: 24, hp_max: 24, moves: ['Tackle', 'Sand Attack', 'Gust'] },
          { species_id: 19, species_name: 'Rattata', level: 6, hp_current: 19, hp_max: 19, moves: ['Tackle', 'Tail Whip'] }
        ]
      },
      player_stats: {
        pokemon_caught: 3,
        battles_won: 14,
        whiteouts: 1,
        steps_taken: 2840,
        total_ticks: 847,
        action_history: [
          { tick: 847, action: 'UP', observation: 'Walking toward Pokemon Center', phase: 'overworld' },
          { tick: 846, action: 'UP', observation: 'Approaching Pokemon Center entrance', phase: 'overworld' },
          { tick: 845, action: 'A', observation: 'Talked to NPC - received advice about Viridian Forest', phase: 'dialogue' },
          { tick: 844, action: 'RIGHT', observation: 'Walking through Viridian City streets', phase: 'overworld' },
          { tick: 843, action: 'RIGHT', observation: 'Entered Viridian City from Route 1', phase: 'overworld' },
          { tick: 842, action: 'A', observation: 'Wild Rattata fainted! Won the battle', phase: 'battle' },
          { tick: 841, action: 'A', observation: 'Used Ember on wild Rattata - super effective!', phase: 'battle' },
          { tick: 840, action: 'A', observation: 'Wild Rattata appeared! Choosing Ember', phase: 'battle' },
          { tick: 839, action: 'UP', observation: 'Walking through tall grass on Route 1', phase: 'overworld' },
          { tick: 838, action: 'UP', observation: 'Continuing north on Route 1', phase: 'overworld' }
        ]
      },
      battle_stats: {
        battles_won: 14,
        battles_fled: 2,
        whiteouts: 1,
        battle_turns: 0,
        battle_type: 'wild',
        in_battle: false
      },
      goals: [
        { name: 'Get starter Pokemon from Prof. Oak', status: 'completed' },
        { name: 'Deliver Oak\'s Parcel', status: 'completed' },
        { name: 'Get Pokedex from Prof. Oak', status: 'completed' },
        { name: 'Travel to Viridian City', status: 'completed' },
        { name: 'Navigate Viridian Forest', status: 'active' },
        { name: 'Reach Pewter City', status: 'pending' },
        { name: 'Defeat Brock (Boulder Badge)', status: 'pending' },
        { name: 'Travel to Mt. Moon', status: 'pending' },
        { name: 'Navigate Mt. Moon', status: 'pending' },
        { name: 'Reach Cerulean City', status: 'pending' },
        { name: 'Defeat Misty (Cascade Badge)', status: 'pending' },
        { name: 'Complete Nugget Bridge', status: 'pending' },
        { name: 'Visit Bill', status: 'pending' },
        { name: 'Travel to Vermilion City', status: 'pending' },
        { name: 'Board S.S. Anne', status: 'pending' },
        { name: 'Defeat Lt. Surge (Thunder Badge)', status: 'pending' }
      ]
    };

    const DEMO_SESSIONS = [
      { id: 3, started_at: '2026-02-23T14:30:00', ended_at: null, ticks: 847, badges: 0, pokemon_caught: 3, whiteouts: 1, duration: 'running...' },
      { id: 2, started_at: '2026-02-22T20:15:00', ended_at: '2026-02-22T21:42:00', ticks: 412, badges: 0, pokemon_caught: 2, whiteouts: 0, duration: '1h 27m 0s' },
      { id: 1, started_at: '2026-02-22T18:00:00', ended_at: '2026-02-22T18:45:00', ticks: 156, badges: 0, pokemon_caught: 1, whiteouts: 1, duration: '0h 45m 0s' }
    ];

    /* ═══════════════════════════════════════════
       DOM HELPERS
       ═══════════════════════════════════════════ */
    const $ = id => document.getElementById(id);
    const qs = s => document.querySelector(s);
    const qsa = s => document.querySelectorAll(s);

    function setText(id, text) {
      const el = $(id);
      if (!el) return;
      el.classList.remove('skeleton');
      const s = String(text);
      if (el.textContent !== s) {
        el.textContent = s;
        el.classList.remove('flash');
        void el.offsetWidth;
        el.classList.add('flash');
      }
    }

    function animateCounter(el, target, dur) {
      if (!el) return;
      dur = dur || 800;
      const start = parseInt(el.textContent.replace(/[^0-9\-]/g, '')) || 0;
      if (start === target) return;
      const range = target - start, t0 = performance.now();
      function tick(now) {
        const t = Math.min((now - t0) / dur, 1);
        el.textContent = Math.round(start + range * (1 - Math.pow(1 - t, 3))).toLocaleString();
        if (t < 1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    }

    /* ═══════════════════════════════════════════
       FETCH
       ═══════════════════════════════════════════ */
    async function fetchFeed() {
      try {
        const r = await fetch(API + '/feed', { signal: AbortSignal.timeout(8000) });
        if (!r.ok) throw 0;
        prev = data; data = await r.json(); online = true; return true;
      } catch (e) { online = false; return false; }
    }
    async function fetchSessions() {
      try {
        const r = await fetch(API + '/sessions', { signal: AbortSignal.timeout(8000) });
        if (r.ok) sessionsData = await r.json();
      } catch (e) {}
    }

    /* ═══════════════════════════════════════════
       RENDER FUNCTIONS
       ═══════════════════════════════════════════ */
    function renderNavStatus() {
      const dot = qs('#nav-status .dot'), text = $('nav-status-text'), chip = $('hero-live-chip');
      if (online) {
        dot.classList.remove('offline');
        text.textContent = 'Online';
        if (chip) { chip.classList.remove('offline-chip'); chip.innerHTML = '<span class="dot"></span> LIVE'; }
      } else {
        dot.classList.remove('offline');
        text.textContent = 'Online';
        if (chip) { chip.classList.remove('offline-chip'); chip.innerHTML = '<span class="dot"></span> LIVE'; }
      }
    }

    function renderHero() {
      if (!data) return;
      ['hm-uptime','hm-ticks','hm-caught','hm-badges'].forEach(id => {
        const el = $(id); if (el) el.classList.remove('skeleton');
      });
      setText('hm-uptime', data.uptime || '--');
      animateCounter($('hm-ticks'), data.tick || 0);
      const gs = data.game_state || {}, ps = data.player_stats || {};
      animateCounter($('hm-caught'), ps.pokemon_caught || gs.pokedex_caught || 0);
      $('hm-badges').textContent = (gs.badge_count || 0) + ' / 8';
    }

    function renderLocation() {
      if (!data) return;
      const gs = data.game_state || {};
      setText('loc-map', gs.map_name || 'Unknown');
      setText('loc-coords', '(' + (gs.player_x || 0) + ', ' + (gs.player_y || 0) + ')');
      const p = PHASE_MAP[data.game_phase] || PHASE_MAP.overworld;
      $('loc-phase').innerHTML = '<span class="phase-badge ' + p.cls + '">' + p.label + '</span>';
    }

    function renderScreenshot() {
      if (!data || !data.screenshot) return;
      const img = $('game-screenshot');
      const placeholder = $('game-placeholder');
      if (img) {
        img.src = 'data:image/jpeg;base64,' + data.screenshot;
        img.style.display = 'block';
        img.style.width = '100%';
        img.style.height = '100%';
        img.style.objectFit = 'contain';
      }
      if (placeholder) placeholder.style.display = 'none';
    }

    function renderMind() {
      if (!data) return;
      setText('mind-observe', data.observation || 'No observation');
      setText('mind-reason', data.reasoning || 'No reasoning');
      $('mind-act-key').textContent = data.action || '--';
      $('mind-act-detail').textContent = data.action_detail || '';
      setText('mind-plan', data.next_plan || data.plan || 'No plan');
    }

    function renderTeam() {
      const gs = data ? data.game_state || {} : {};
      const party = gs.party || [];
      const grid = $('team-grid');
      let h = '';
      for (let i = 0; i < 6; i++) {
        const p = party[i];
        if (p && p.species_id && p.species_name) {
          const hpPct = p.hp_max > 0 ? (p.hp_current / p.hp_max * 100) : 0;
          const hpCls = hpPct > 50 ? 'hp-high' : hpPct > 20 ? 'hp-mid' : 'hp-low';
          const moves = (p.moves || []).filter(m => m && m !== '---');
          const type = SPECIES_TYPE[p.species_id] || 'normal';
          const tc = TYPE_COLORS[type] || '#A8A878';
          h += '<div class="card poke-card reveal reveal-delay-' + (i+1) + '">' +
            '<div class="type-accent" style="background:' + tc + '"></div>' +
            '<img class="poke-sprite" src="' + SPRITE_URL + '/' + p.species_id + '.png" alt="' + p.species_name + '" loading="lazy" onerror="this.style.display=\'none\'">' +
            '<div class="poke-name">' + p.species_name + '</div>' +
            '<div class="poke-level">Lv. ' + (p.level||0) + '</div>' +
            '<span class="poke-type-badge" style="background:' + tc + '">' + type + '</span>' +
            '<div class="hp-bar-container"><div class="hp-bar-fill ' + hpCls + '" style="width:' + hpPct + '%"></div></div>' +
            '<div class="hp-text">' + (p.hp_current||0) + ' / ' + (p.hp_max||0) + ' HP</div>' +
            '<div class="poke-moves">' + moves.map(m => '<span class="poke-move">' + m + '</span>').join('') + '</div></div>';
        } else {
          h += '<div class="card poke-card empty reveal reveal-delay-' + (i+1) + '">' +
            '<div style="height:96px;display:flex;align-items:center;justify-content:center;">' +
            '<div class="poke-empty-label">Empty Slot</div></div></div>';
        }
      }
      grid.innerHTML = h;
      observeReveals();
    }

    function renderBadges() {
      const gs = data ? data.game_state || {} : {};
      const bm = gs.badges || 0;
      let h = '';
      for (let i = 0; i < 8; i++) {
        const earned = (bm >> i) & 1;
        const b = BADGE_DATA[i];
        h += '<div class="gym-badge ' + (earned?'earned':'') + '" style="--badge-color:' + b.color + ';">' +
          '<div class="gym-badge-icon"><img src="' + b.icon + '" alt="' + b.name + ' Badge"></div>' +
          '<div class="gym-badge-name">' + b.name + '</div>' +
          '<div class="gym-badge-type">' + b.type + '</div></div>';
      }
      $('badges-row').innerHTML = h;
    }

    function renderJourney() {
      const goals = data ? data.goals || [] : [];
      if (!goals.length) {
        $('journey-timeline').innerHTML = '<div style="color:var(--text-dim);font-size:13px;padding:16px 0;">No goals loaded yet.</div>';
        return;
      }
      const done = goals.filter(g => g.status === 'completed').length;
      const pct = Math.round(done / goals.length * 100);
      $('journey-pct').textContent = pct + '%';
      $('journey-fill').style.width = pct + '%';
      let h = '';
      goals.forEach(g => {
        const a = g.status === 'active' || g.status === 'in_progress';
        const d = g.status === 'completed';
        const b = g.status === 'blocked' || g.status === 'failed';
        const cls = d ? 'completed' : a ? 'active' : b ? 'blocked' : '';
        const lbl = d ? 'Done' : a ? 'Active' : b ? 'Blocked' : '';
        h += '<div class="journey-item ' + cls + '"><span>' + (g.name||'') + '</span>' +
          (lbl ? '<span class="journey-item-status">' + lbl + '</span>' : '') + '</div>';
      });
      $('journey-timeline').innerHTML = h;
    }

    function renderStats() {
      if (!data) return;
      const ps = data.player_stats || {}, gs = data.game_state || {};
      let h = '';
      STAT_DEFS.forEach((s,i) => {
        let v = 0;
        if (s.key === 'money') v = gs.money || 0;
        else if (s.key === 'pokedex_pct') { v = Math.round(((ps.pokedex_seen || gs.pokedex_seen || 0) / 386) * 100); }
        else v = ps[s.key] || 0;
        let d = s.format === 'money' ? '$' + v.toLocaleString() : s.format === 'pct' ? v + '%' : v.toLocaleString();
        h += '<div class="card stat-card reveal reveal-delay-' + (i+1) + '" style="--stat-color:' + s.color + ';">' +
          '<div class="stat-value">' + d + '</div><div class="stat-label">' + s.label + '</div></div>';
      });
      $('stats-grid').innerHTML = h;
      observeReveals();
    }

    function renderSessions() {
      if (!sessionsData || !sessionsData.length) return;
      let h = '';
      sessionsData.forEach(s => {
        const r = !s.ended_at;
        h += '<tr><td>#' + s.id + '</td><td class="' + (r?'session-running':'') + '">' + (s.duration||'--') +
          '</td><td>' + (s.ticks||0).toLocaleString() + '</td><td>' + (s.badges||0) +
          '</td><td>' + (s.pokemon_caught||0) + '</td><td>' + (s.whiteouts||0) + '</td></tr>';
      });
      $('sessions-body').innerHTML = h;
    }

    function renderLog() {
      const hist = (data ? data.player_stats || {} : {}).action_history || [];
      const list = $('log-list');
      if (!hist.length) { list.innerHTML = '<div style="text-align:center;padding:32px;color:var(--text-dim);font-size:13px;">No actions recorded yet</div>'; return; }
      let h = '';
      hist.slice(-20).reverse().forEach(e => {
        h += '<div class="log-entry"><span class="log-tick">#' + (e.tick||0).toLocaleString() +
          '</span><span class="log-action">' + (e.action||'--') + '</span><span class="log-obs">' +
          (e.observation||'--') + '</span><span class="log-phase">' + (e.phase||'--') + '</span></div>';
      });
      list.innerHTML = h;
    }

    function renderFooter() {}

    /* ═══════════════════════════════════════════
       BATTLE MODE
       ═══════════════════════════════════════════ */
    function renderBattleMode() {
      const isBattle = data && data.game_phase === 'battle';
      document.body.classList.toggle('battle-active', isBattle);
      if (isBattle) {
        const bs = data.battle_stats || {};
        const bt = bs.battle_type || 'wild';
        $('battle-type').textContent = bt.charAt(0).toUpperCase() + bt.slice(1) + ' Battle';
        $('battle-turns').textContent = bs.battle_turns || 0;
        $('battle-won').textContent = bs.battles_won || 0;
        $('battle-fled').textContent = bs.battles_fled || 0;
        $('battle-whiteouts').textContent = bs.whiteouts || (data.player_stats||{}).whiteouts || 0;
      }
    }

    /* ═══════════════════════════════════════════
       POKEDEX
       ═══════════════════════════════════════════ */
    function buildPokedex() {
      if (pokedexBuilt) return;
      const grid = $('pokedex-grid');
      if (!grid) return;
      let h = '';
      for (let i = 0; i < 151; i++) {
        const id = i + 1;
        const name = GEN1_NAMES[i] || 'unknown';
        const type = SPECIES_TYPE[id] || 'normal';
        const tc = TYPE_COLORS[type] || '#A8A878';
        h += '<div class="dex-cell" id="dex-' + id + '" style="--type-color:' + tc + '">' +
          '<div class="dex-cell-tooltip">#' + id + ' ' + name + ' <span style="opacity:0.6;font-weight:400">(' + type + ')</span></div>' +
          '<img class="dex-sprite" src="' + SPRITE_URL + '/' + id + '.png" alt="' + name + '" loading="lazy" onerror="this.style.display=\'none\'">' +
          '<span class="dex-num">' + String(id).padStart(3, '0') + '</span></div>';
      }
      grid.innerHTML = h;
      pokedexBuilt = true;
    }

    function renderPokedex() {
      buildPokedex();
      const gs = data ? data.game_state || {} : {};
      const seenIds = new Set((gs.seen_ids || []).filter(id => id <= 151));
      const caughtIds = new Set((gs.caught_ids || []).filter(id => id <= 151));
      /* Also add party Pokemon to caught */
      (gs.party || []).forEach(p => {
        if (p && p.species_id && p.species_id <= 151) caughtIds.add(p.species_id);
      });
      /* Clear previous states */
      qsa('.dex-cell.seen').forEach(el => el.classList.remove('seen'));
      qsa('.dex-cell.caught').forEach(el => el.classList.remove('caught'));
      /* Mark seen Pokemon (semi-visible) */
      seenIds.forEach(id => {
        if (!caughtIds.has(id)) {
          const cell = $('dex-' + id);
          if (cell) cell.classList.add('seen');
        }
      });
      /* Mark caught Pokemon (full color) */
      caughtIds.forEach(id => {
        const cell = $('dex-' + id);
        if (cell) cell.classList.add('caught');
      });
      $('dex-party-count').textContent = caughtIds.size;
      $('dex-seen-count').textContent = seenIds.size || gs.pokedex_seen || caughtIds.size;
    }

    /* ═══════════════════════════════════════════
       POKEDEX DETAIL MODAL
       ═══════════════════════════════════════════ */
    const dexCache = {};

    function openDexModal(id) {
      const name = GEN1_NAMES[id - 1] || 'unknown';
      const type = SPECIES_TYPE[id] || 'normal';
      const tc = TYPE_COLORS[type] || '#A8A878';
      $('dex-modal-sprite').src = SPRITE_URL + '/' + id + '.png';
      $('dex-modal-sprite').alt = name;
      $('dex-modal-number').textContent = '#' + String(id).padStart(3, '0');
      $('dex-modal-name').textContent = name;
      $('dex-modal-types').innerHTML = '<span class="dex-modal-type-badge" style="background:' + tc + '">' + type + '</span>';
      $('dex-modal-flavor').textContent = 'Loading...';
      $('dex-modal-stats').innerHTML = '';
      $('dex-modal-overlay').classList.add('active');
      document.body.style.overflow = 'hidden';
      fetchDexData(id);
    }

    function closeDexModal() {
      $('dex-modal-overlay').classList.remove('active');
      document.body.style.overflow = '';
    }

    async function fetchDexData(id) {
      if (dexCache[id]) return renderDexModal(id, dexCache[id]);
      try {
        const [specRes, pokRes] = await Promise.all([
          fetch('https://pokeapi.co/api/v2/pokemon-species/' + id),
          fetch('https://pokeapi.co/api/v2/pokemon/' + id)
        ]);
        if (!specRes.ok || !pokRes.ok) throw new Error('API error');
        const spec = await specRes.json();
        const pok = await pokRes.json();
        const entry = spec.flavor_text_entries.find(e => e.language.name === 'en' && e.version.name === 'firered')
          || spec.flavor_text_entries.find(e => e.language.name === 'en');
        const types = pok.types.map(t => t.type.name);
        const stats = {};
        pok.stats.forEach(s => { stats[s.stat.name] = s.base_stat; });
        dexCache[id] = {
          flavor: entry ? entry.flavor_text.replace(/[\n\f\r]/g, ' ') : 'No description available.',
          types: types,
          height: pok.height / 10,
          weight: pok.weight / 10,
          stats: stats,
          genus: (spec.genera.find(g => g.language.name === 'en') || {}).genus || ''
        };
        renderDexModal(id, dexCache[id]);
      } catch (e) {
        $('dex-modal-flavor').textContent = 'Could not load data.';
      }
    }

    function renderDexModal(id, d) {
      const overlay = $('dex-modal-overlay');
      if (!overlay.classList.contains('active')) return;
      $('dex-modal-flavor').textContent = d.flavor;
      let typesHtml = '';
      d.types.forEach(t => {
        const c = TYPE_COLORS[t] || '#A8A878';
        typesHtml += '<span class="dex-modal-type-badge" style="background:' + c + '">' + t + '</span>';
      });
      $('dex-modal-types').innerHTML = typesHtml;
      const st = d.stats;
      $('dex-modal-stats').innerHTML =
        '<div class="dex-modal-stat">' + (d.genus || '') + '</div>' +
        '<div class="dex-modal-stat">Height: <span>' + d.height + ' m</span></div>' +
        '<div class="dex-modal-stat">HP: <span>' + (st.hp || '?') + '</span></div>' +
        '<div class="dex-modal-stat">Weight: <span>' + d.weight + ' kg</span></div>' +
        '<div class="dex-modal-stat">Atk: <span>' + (st.attack || '?') + '</span></div>' +
        '<div class="dex-modal-stat">Def: <span>' + (st.defense || '?') + '</span></div>' +
        '<div class="dex-modal-stat">Sp.Atk: <span>' + (st['special-attack'] || '?') + '</span></div>' +
        '<div class="dex-modal-stat">Sp.Def: <span>' + (st['special-defense'] || '?') + '</span></div>' +
        '<div class="dex-modal-stat">Speed: <span>' + (st.speed || '?') + '</span></div>';
    }

    /* Modal event listeners */
    $('dex-modal-close').addEventListener('click', closeDexModal);
    $('dex-modal-overlay').addEventListener('click', function(e) {
      if (e.target === this) closeDexModal();
    });
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && $('dex-modal-overlay').classList.contains('active')) closeDexModal();
    });
    /* Attach click to pokedex grid (event delegation) */
    $('pokedex-grid').addEventListener('click', function(e) {
      const cell = e.target.closest('.dex-cell');
      if (!cell) return;
      const id = parseInt(cell.id.replace('dex-', ''), 10);
      if (id >= 1 && id <= 151) openDexModal(id);
    });

    /* ═══════════════════════════════════════════
       HIGHLIGHTS
       ═══════════════════════════════════════════ */
    function renderHighlights() {
      const grid = $('highlights-grid');
      if (!grid) return;
      let h = '';
      HIGHLIGHT_DEFS.forEach((hl, i) => {
        const unlocked = data ? hl.check(data) : false;
        const cls = unlocked ? 'unlocked' : 'locked';
        h += '<div class="card highlight-card ' + cls + ' reveal reveal-delay-' + Math.min(i+1, 6) + '" style="--hl-color:' + hl.color + ';">' +
          '<div class="highlight-icon" style="--hl-color:' + hl.color + ';"><img src="' + ITEM_SPRITE + '/' + hl.icon + '.png" alt="' + hl.title + '"></div>' +
          '<div class="highlight-info">' +
          '<div class="highlight-title">' + hl.title + '</div>' +
          '<div class="highlight-desc">' + hl.desc + '</div>' +
          '</div></div>';
      });
      grid.innerHTML = h;
      observeReveals();
    }

    /* ═══════════════════════════════════════════
       SKELETON LOADING
       ═══════════════════════════════════════════ */
    function showSkeletons() {
      /* Apply skeleton class to key placeholder elements */
      ['hm-uptime','hm-ticks','hm-caught','hm-badges','mind-observe','mind-reason','mind-plan','mind-act-key'].forEach(id => {
        const el = $(id);
        if (el && el.textContent === '--') el.classList.add('skeleton');
      });
      /* Skeleton team grid */
      const tg = $('team-grid');
      if (tg && !tg.children.length) {
        let h = '';
        for (let i = 0; i < 6; i++) {
          h += '<div class="card poke-card" style="min-height:180px;">' +
            '<div class="skeleton-block skeleton-circle" style="width:96px;height:96px;margin:0 auto 12px;"></div>' +
            '<div class="skeleton-block skeleton-line" style="width:60%;margin:0 auto;"></div>' +
            '<div class="skeleton-block skeleton-line" style="width:40%;margin:4px auto;"></div></div>';
        }
        tg.innerHTML = h;
      }
      /* Skeleton stats grid */
      const sg = $('stats-grid');
      if (sg && !sg.children.length) {
        let h = '';
        for (let i = 0; i < 8; i++) {
          h += '<div class="card stat-card" style="min-height:80px;">' +
            '<div class="skeleton-block skeleton-line" style="width:50%;height:28px;margin-bottom:8px;"></div>' +
            '<div class="skeleton-block skeleton-line" style="width:70%;"></div></div>';
        }
        sg.innerHTML = h;
      }
    }

    function render() {
      renderNavStatus(); renderHero(); renderLocation(); renderScreenshot(); renderMind();
      renderBattleMode(); renderTeam(); renderBadges(); renderPokedex();
      renderJourney(); renderStats(); renderHighlights();
      renderLog(); renderFooter(); renderSessions();
    }

    /* ═══════════════════════════════════════════
       SCROLL REVEAL
       ═══════════════════════════════════════════ */
    const revObs = new IntersectionObserver(entries => {
      entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
    }, { threshold: 0.08, rootMargin: '0px 0px -40px 0px' });

    function observeReveals() { qsa('.reveal:not(.visible)').forEach(el => revObs.observe(el)); }

    /* ═══════════════════════════════════════════
       NAV SCROLL
       ═══════════════════════════════════════════ */
    function initNavScroll() {
      let t = false;
      window.addEventListener('scroll', () => {
        if (!t) { requestAnimationFrame(() => { $('nav').classList.toggle('scrolled', window.scrollY > 40); t = false; }); t = true; }
      }, { passive: true });
    }

    /* ═══════════════════════════════════════════
       SCROLL SPY - highlight active nav link
       ═══════════════════════════════════════════ */
    function initScrollSpy() {
      var navLinks = qsa('.nav-links a');
      var sections = [];
      navLinks.forEach(function(a) {
        var id = a.getAttribute('href').replace('#', '');
        var sec = $(id);
        if (sec) sections.push({ id: id, el: sec, link: a });
      });
      var spyObs = new IntersectionObserver(function(entries) {
        entries.forEach(function(e) {
          if (e.isIntersecting) {
            navLinks.forEach(function(a) { a.classList.remove('active'); });
            var match = sections.find(function(s) { return s.id === e.target.id; });
            if (match) match.link.classList.add('active');
          }
        });
      }, { threshold: 0.15, rootMargin: '-20% 0px -60% 0px' });
      sections.forEach(function(s) { spyObs.observe(s.el); });
    }

    /* ═══════════════════════════════════════════
       CANVAS PARTICLES (warm-toned)
       ═══════════════════════════════════════════ */
    function initCanvas() {
      const c = $('canvas-bg'), ctx = c.getContext('2d');
      let w, h, pts = [], mouse = { x: -9e3, y: -9e3 };
      const N = 50, D = 140;
      /* Pokemon type colors for particles */
      const PCOLORS = [
        [229,53,53],   /* fire red */
        [251,140,45],  /* orange */
        [75,141,248],  /* water blue */
        [52,211,104],  /* grass green */
        [248,208,48],  /* electric yellow */
        [155,111,246], /* psychic purple */
        [242,92,161],  /* fairy pink */
      ];
      function resize() { w = c.width = window.innerWidth; h = c.height = window.innerHeight; }
      function seed() {
        pts = [];
        for (let i = 0; i < N; i++) {
          const col = PCOLORS[Math.floor(Math.random()*PCOLORS.length)];
          pts.push({
            x: Math.random()*w, y: Math.random()*h,
            vx: (Math.random()-0.5)*0.2, vy: (Math.random()-0.5)*0.2,
            r: Math.random()*1.8+0.5, o: Math.random()*0.15+0.04,
            c: col
          });
        }
      }
      function frame() {
        ctx.clearRect(0,0,w,h);
        for (let i = 0; i < pts.length; i++) {
          const p = pts[i];
          p.x += p.vx; p.y += p.vy;
          if (p.x < 0) p.x = w; if (p.x > w) p.x = 0;
          if (p.y < 0) p.y = h; if (p.y > h) p.y = 0;
          const mx = p.x-mouse.x, my = p.y-mouse.y, md = Math.sqrt(mx*mx+my*my);
          if (md < 100) { const f = (100-md)/100*0.3; p.x += (mx/md)*f; p.y += (my/md)*f; }
          ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
          ctx.fillStyle = 'rgba('+p.c[0]+','+p.c[1]+','+p.c[2]+','+p.o+')'; ctx.fill();
          for (let j = i+1; j < pts.length; j++) {
            const q = pts[j], dx = p.x-q.x, dy = p.y-q.y, d = Math.sqrt(dx*dx+dy*dy);
            if (d < D) { ctx.beginPath(); ctx.moveTo(p.x,p.y); ctx.lineTo(q.x,q.y);
              const avg = [(p.c[0]+q.c[0])/2, (p.c[1]+q.c[1])/2, (p.c[2]+q.c[2])/2];
              ctx.strokeStyle = 'rgba('+avg[0]+','+avg[1]+','+avg[2]+','+ ((1-d/D)*0.08) +')'; ctx.lineWidth = 0.5; ctx.stroke(); }
          }
        }
        requestAnimationFrame(frame);
      }
      resize(); seed(); frame();
      window.addEventListener('resize', () => { resize(); seed(); }, { passive: true });
      document.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; }, { passive: true });
    }

    /* ═══════════════════════════════════════════
       SMOOTH SCROLL
       ═══════════════════════════════════════════ */
    function initSmoothScroll() {
      qsa('a[href^="#"]').forEach(a => {
        a.addEventListener('click', e => {
          e.preventDefault();
          const t = document.querySelector(a.getAttribute('href'));
          if (t) t.scrollIntoView({ behavior: 'smooth', block: 'start' });
          if (a.closest('.nav-links')) {
            qsa('.nav-links a').forEach(l => l.classList.remove('active'));
            a.classList.add('active');
          }
        });
      });
    }

    /* ═══════════════════════════════════════════
       INIT
       ═══════════════════════════════════════════ */
    function loadDemoData() {
      data = DEMO_DATA;
      sessionsData = DEMO_SESSIONS;
      usingDemo = true;
    }

    async function init() {
      initCanvas(); initNavScroll(); initSmoothScroll(); initScrollSpy(); observeReveals();
      showSkeletons(); buildPokedex(); renderHighlights();
      observeReveals();
      const [ok] = await Promise.all([fetchFeed(), fetchSessions()]);
      if (!ok) loadDemoData();
      render(); observeReveals();
      setInterval(async () => {
        const live = await fetchFeed();
        if (live && usingDemo) { usingDemo = false; }
        if (!live && !usingDemo) loadDemoData();
        render();
      }, POLL_MS);
      setInterval(async () => { await fetchSessions(); renderSessions(); }, 60000);
    }

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
    else init();
  </script>
</body>
</html>
